/**
 * mOxie - multi-runtime File API & XMLHttpRequest L2 Polyfill
 * v1.5.8
 *
 * Copyright 2013, Moxiecode Systems AB
 * Released under GPL License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2018-02-19
 */
/**
 * Plupload - multi-runtime File Uploader
 * v3.1.2
 *
 * Copyright 2018, Ephox
 * Released under AGPLv3 License.
 *
 * License: http://www.plupload.com/license
 * Contributing: http://www.plupload.com/contributing
 *
 * Date: 2018-02-20
 */
/**
 * Build for NukeViet
 * Fix bug https://github.com/moxiecode/plupload/issues/1510 to use
 */
var MXI_DEBUG=!1;
(function(t,E){var D=function(){var n={};E.apply(n,arguments);return n.moxie};"function"===typeof define&&define.amd?define("moxie",[],D):"object"===typeof module&&module.exports?module.exports=D():t.moxie=D()})(this||window,function(){(function(t,E){function D(g,c){for(var d,b=[],a=0;a<g.length;++a){if(!(d=w[g[a]]))a:{d=t;for(var f=g[a].split(/[.\/]/),e=0;e<f.length;++e){if(!d[f[e]]){d=void 0;break a}d=d[f[e]]}}if(!d)throw"module definition dependecy not found: "+g[a];b.push(d)}c.apply(null,b)}function n(g,
c,d){if("string"!==typeof g)throw"invalid module definition, module id must be defined and be a string";if(c===E)throw"invalid module definition, dependencies must be specified";if(d===E)throw"invalid module definition, definition function must be specified";D(c,function(){w[g]=d.apply(null,arguments)})}var w={};n("moxie/core/utils/Basic",[],function(){function g(a){return void 0===a?"undefined":null===a?"null":a.nodeType?"node":{}.toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()}function c(){return d(!1,
!1,arguments)}function d(f,e,m){var k=m[0];b(m,function(h,m){0<m&&b(h,function(b,h){var m=-1!==a(g(b),["array","object"]);if(void 0===b||f&&void 0===k[h])return!0;if(m&&e)a:{var l=b;switch(g(l)){case "array":b=Array.prototype.slice.call(l);break a;case "object":b=c({},l);break a}b=l}g(k[h])===g(b)&&m?d(f,e,[k[h],b]):k[h]=b})});return k}function b(a,e){var b;if(a){try{var f=a.length}catch(h){f=void 0}if(void 0===f||"number"!==typeof f)for(b in a){if(a.hasOwnProperty(b)&&!1===e(a[b],b))break}else for(b=
0;b<f&&!1!==e(a[b],b);b++);}}function a(a,e){if(e){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(e,a);for(var b=0,f=e.length;b<f;b++)if(e[b]===a)return b}return-1}return{guid:function(){var a=0;return function(b){var e=(new Date).getTime().toString(32),f;for(f=0;5>f;f++)e+=Math.floor(65535*Math.random()).toString(32);return(b||"o_")+e+(a++).toString(32)}}(),typeOf:g,extend:c,extendIf:function(){return d(!0,!1,arguments)},extendImmutable:function(){return d(!1,!0,arguments)},extendImmutableIf:function(){return d(!0,
!0,arguments)},clone:function(a){switch(g(a)){case "array":return d(!1,!0,[[],a]);case "object":return d(!1,!0,[{},a]);default:return a}},inherit:function(a,b){function e(){this.constructor=a;if(MXI_DEBUG){var b=a.toString().match(/^function\s([^\(\s]+)/);this.ctorName=b?b[1]:!1}}for(var f in b)({}).hasOwnProperty.call(b,f)&&(a[f]=b[f]);e.prototype=b.prototype;a.prototype=new e;a.parent=b.prototype;return a},each:b,isEmptyObj:function(a){var b;if(!a||"object"!==g(a))return!0;for(b in a)return!1;return!0},
inSeries:function(a,b){function e(h){if("function"===g(a[h]))a[h](function(a){++h<f&&!a?e(h):b(a)})}var f=a.length;"function"!==g(b)&&(b=function(){});a&&a.length||b();e(0)},inParallel:function(a,e){var f=0,c=a.length,h=Array(c);b(a,function(a,b){a(function(a){if(a)return e(a);var d=[].slice.call(arguments);d.shift();h[b]=d;f++;f===c&&(h.unshift(null),e.apply(this,h))})})},inArray:a,arrayDiff:function(b,e){var f=[];"array"!==g(b)&&(b=[b]);"array"!==g(e)&&(e=[e]);for(var c in b)-1===a(b[c],e)&&f.push(b[c]);
return f.length?f:!1},arrayIntersect:function(f,e){var c=[];b(f,function(b){-1!==a(b,e)&&c.push(b)});return c.length?c:null},toArray:function(a){var b,f=[];for(b=0;b<a.length;b++)f[b]=a[b];return f},trim:function(a){return a?String.prototype.trim?String.prototype.trim.call(a):a.toString().replace(/^\s*/,"").replace(/\s*$/,""):a},sprintf:function(a){var b=[].slice.call(arguments,1);return a.replace(/%([a-z])/g,function(a,e){var h=b.shift();switch(e){case "s":return h+"";case "d":return parseInt(h,
10);case "f":return parseFloat(h);case "c":return"";default:return h}})},parseSizeStr:function(a){if("string"!==typeof a)return a;var b={t:1099511627776,g:1073741824,m:1048576,k:1024};a=/^([0-9\.]+)([tmgk]?)$/.exec(a.toLowerCase().replace(/[^0-9\.tmkg]/g,""));var c=a[2];a=+a[1];b.hasOwnProperty(c)&&(a*=b[c]);return Math.floor(a)},delay:function(a,b){var e=this;setTimeout(function(){a.call(e)},b||1)}}});n("moxie/core/utils/Encode",[],function(){var g=function(c){return unescape(encodeURIComponent(c))},
c=function(c){return decodeURIComponent(escape(c))};return{utf8_encode:g,utf8_decode:c,atob:function(d,b){if("function"===typeof window.atob)return b?c(window.atob(d)):window.atob(d);var a=0,f=0,e=[];if(!d)return d;d+="";do{var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(a++));var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(a++));var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(a++));
var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(d.charAt(a++));var q=m<<18|k<<12|h<<6|l;m=q>>16&255;k=q>>8&255;q&=255;64==h?e[f++]=String.fromCharCode(m):64==l?e[f++]=String.fromCharCode(m,k):e[f++]=String.fromCharCode(m,k,q)}while(a<d.length);h=e.join("");return b?c(h):h},btoa:function(c,b){b&&(c=g(c));if("function"===typeof window.btoa)return window.btoa(c);var a=0,f=0,e=[];if(!c)return c;do{var d=c.charCodeAt(a++);var k=c.charCodeAt(a++);var h=c.charCodeAt(a++);
var l=d<<16|k<<8|h;d=l>>18&63;k=l>>12&63;h=l>>6&63;l&=63;e[f++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(h)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)}while(a<c.length);a=e.join("");f=c.length%3;return(f?a.slice(0,f-3):a)+"===".slice(f||3)}}});n("moxie/core/utils/Env",["moxie/core/utils/Basic"],
function(g){var c=function(a){var b={has:function(a,b){return-1!==b.toLowerCase().indexOf(a.toLowerCase())},lowerize:function(a){return a.toLowerCase()}},c=function(){for(var b,e=0,c,h,f,d,m,l=arguments;e<l.length;e+=2){m=l[e];var k=l[e+1];if("undefined"===typeof b)for(f in b={},k)c=k[f],"object"===typeof c?b[c[0]]=a:b[c]=a;for(c=h=0;c<m.length;c++)if(d=m[c].exec(this.getUA())){for(f=0;f<k.length;f++)m=d[++h],c=k[f],"object"===typeof c&&0<c.length?2==c.length?b[c[0]]="function"==typeof c[1]?c[1].call(this,
m):c[1]:3==c.length?b[c[0]]="function"!==typeof c[1]||c[1].exec&&c[1].test?m?m.replace(c[1],c[2]):a:m?c[1].call(this,m,c[2]):a:4==c.length&&(b[c[0]]=m?c[3].call(this,m.replace(c[1],c[2])):a):b[c]=m?m:a;break}if(d)break}return b},f=function(c,e){for(var h in e)if("object"===typeof e[h]&&0<e[h].length)for(var f=0;f<e[h].length;f++){if(b.has(e[h][f],c))return"?"===h?a:h}else if(b.has(e[h],c))return"?"===h?a:h;return c},h={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2E3:"NT 5.0",XP:["NT 5.1","NT 5.2"],
Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",RT:"ARM"},d=[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],["name","version"],[/\s(opr)\/([\w\.]+)/i],[["name","Opera"],"version"],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],
["name","version"],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[["name","IE"],"version"],[/(edge)\/((\d+)?[\w\.]+)/i],["name","version"],[/(yabrowser)\/([\w\.]+)/i],[["name","Yandex"],"version"],[/(comodo_dragon)\/([\w\.]+)/i],[["name",/_/g," "],"version"],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],["name","version"],[/(dolfin)\/([\w\.]+)/i],[["name","Dolphin"],"version"],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[["name","Chrome"],
"version"],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],["version",["name","MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],["version",["name","Android Browser"]],[/FBAV\/([\w\.]+);/i],["version",["name","Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],["version",["name","Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],["version","name"],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],["name",["version",f,{"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412",
"2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],["name","version"],[/(navigator|netscape)\/([\w\.-]+)/i],[["name","Netscape"],"version"],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,
/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],["name","version"]],q=[[/windows.+\sedge\/([\w\.]+)/i],["version",["name","EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],["name","version"],[/rv:([\w\.]+).*(gecko)/i],["version","name"]],r=[[/microsoft\s(windows)\s(vista|xp)/i],["name","version"],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],
["name",["version",f,h]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[["name","Windows"],["version",f,h]],[/\((bb)(10);/i],[["name","BlackBerry"],"version"],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palmos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],["name","version"],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[["name","Symbian"],"version"],[/\((series40);/i],["name"],[/mozilla.+\(mobile;.+gecko.+firefox/i],[["name",
"Firefox OS"],"version"],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],["name","version"],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[["name","Chromium OS"],"version"],[/(sunos)\s?([\w\.]+\d)*/i],[["name","Solaris"],"version"],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],
["name","version"],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[["name","iOS"],["version",/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[["name","Mac OS"],["version",/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],["name","version"]];return function(a){var b=a||(window&&window.navigator&&window.navigator.userAgent?
window.navigator.userAgent:"");this.getBrowser=function(){return c.apply(this,d)};this.getEngine=function(){return c.apply(this,q)};this.getOS=function(){return c.apply(this,r)};this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}};this.getUA=function(){return b};this.setUA=function(a){b=a;return this};this.setUA(b)}}(),d=function(){var b={access_global_ns:function(){return!!window.moxie},define_property:!1,create_canvas:function(){var a=
document.createElement("canvas");a=!(!a.getContext||!a.getContext("2d"));return b.create_canvas=a},return_response_type:function(a){try{if(-1!==g.inArray(a,["","text","document"]))return!0;if(window.XMLHttpRequest){var b=new XMLHttpRequest;b.open("get","/");if("responseType"in b)return b.responseType=a,b.responseType!==a?!1:!0}}catch(k){}return!1},use_blob_uri:function(){var c=window.URL;b.use_blob_uri=c&&"createObjectURL"in c&&"revokeObjectURL"in c&&("IE"!==a.browser||a.verComp(a.version,"11.0.46",
">="));return b.use_blob_uri},use_data_uri:function(){var a=new Image;a.onload=function(){b.use_data_uri=1===a.width&&1===a.height};setTimeout(function(){a.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1);return!1}(),use_data_uri_over32kb:function(){return b.use_data_uri&&("IE"!==a.browser||9<=a.version)},use_data_uri_of:function(a){return b.use_data_uri&&33E3>a||b.use_data_uri_over32kb()},use_fileinput:function(){if(navigator.userAgent.match(/(Android (1.0|1.1|1.5|1.6|2.0|2.1))|(Windows Phone (OS 7|8.0))|(XBLWP)|(ZuneWP)|(w(eb)?OSBrowser)|(webOS)|(Kindle\/(1.0|2.0|2.5|3.0))/))return!1;
var a=document.createElement("input");a.setAttribute("type","file");return b.use_fileinput=!a.disabled},use_webgl:function(){var a=document.createElement("canvas"),c=null;try{c=a.getContext("webgl")||a.getContext("experimental-webgl")}catch(k){}c||(c=null);a=!!c;return b.use_webgl=a}};return function(a){var c=[].slice.call(arguments);c.shift();return"function"===g.typeOf(b[a])?b[a].apply(this,c):!!b[a]}}(),b=(new c).getResult(),a={can:d,uaParser:c,browser:b.browser.name,version:b.browser.version,
os:b.os.name,osVersion:b.os.version,verComp:function(a,b,c){var e=0,h=0,d=0,f={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1};e=function(a){a=(""+a).replace(/[_\-+]/g,".");a=a.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,".");return a.length?a.split("."):[-8]};var m=function(a){return a?isNaN(a)?f[a]||-7:parseInt(a,10):0};a=e(a);b=e(b);h=Math.max(a.length,b.length);for(e=0;e<h;e++)if(a[e]!=b[e])if(a[e]=m(a[e]),b[e]=m(b[e]),a[e]<b[e]){d=-1;break}else if(a[e]>b[e]){d=1;break}if(!c)return d;
switch(c){case ">":case "gt":return 0<d;case ">=":case "ge":return 0<=d;case "<=":case "le":return 0>=d;case "==":case "=":case "eq":return 0===d;case "<>":case "!=":case "ne":return 0!==d;case "":case "<":case "lt":return 0>d;default:return null}},swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};a.OS=a.os;MXI_DEBUG&&(a.debug={runtime:!0,events:!1},a.log=function(){if(window&&window.console&&window.console.log&&
window.console.log.apply)window.console.log.apply(window.console,arguments);else if(document){var a=document.getElementById("moxie-console");a||(a=document.createElement("pre"),a.id="moxie-console",document.body.appendChild(a));var b=arguments[0];if("string"===g.typeOf(b))b=g.sprintf.apply(this,arguments);else if(-1!==g.inArray(g.typeOf(b),["object","array"])){a.appendChild(document.createTextNode(b+"\n"));return}a.appendChild(document.createTextNode(b+"\n"))}});return a});n("moxie/core/Exceptions",
["moxie/core/utils/Basic"],function(g){function c(c,b){for(var a in c)if(c[a]===b)return a;return null}return{RuntimeError:function(){function d(a,d){this.code=a;this.name=c(b,a);this.message=this.name+(d||": RuntimeError "+this.code)}var b={NOT_INIT_ERR:1,EXCEPTION_ERR:3,NOT_SUPPORTED_ERR:9,JS_ERR:4};g.extend(d,b);d.prototype=Error.prototype;return d}(),OperationNotAllowedException:function(){function c(b){this.code=b;this.name="OperationNotAllowedException"}g.extend(c,{NOT_ALLOWED_ERR:1});c.prototype=
Error.prototype;return c}(),ImageError:function(){function d(a){this.code=a;this.name=c(b,a);this.message=this.name+": ImageError "+this.code}var b={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2,INVALID_META_ERR:3};g.extend(d,b);d.prototype=Error.prototype;return d}(),FileException:function(){function d(a){this.code=a;this.name=c(b,a);this.message=this.name+": FileException "+this.code}var b={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,
SYNTAX_ERR:8};g.extend(d,b);d.prototype=Error.prototype;return d}(),DOMException:function(){function d(a){this.code=a;this.name=c(b,a);this.message=this.name+": DOMException "+this.code}var b={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,
VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};g.extend(d,b);d.prototype=Error.prototype;return d}(),EventException:function(){function c(b){this.code=b;this.name="EventException"}g.extend(c,{UNSPECIFIED_EVENT_TYPE_ERR:0});c.prototype=Error.prototype;return c}()}});n("moxie/core/utils/Dom",["moxie/core/utils/Env"],function(g){var c=function(c,b){return c.className?
(new RegExp("(^|\\s+)"+b+"(\\s+|$)")).test(c.className):!1};return{get:function(c){return"string"!==typeof c?c:document.getElementById(c)},hasClass:c,addClass:function(d,b){c(d,b)||(d.className=d.className?d.className.replace(/\s+$/,"")+" "+b:b)},removeClass:function(c,b){c.className&&(c.className=c.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),function(a,b,c){return" "===b&&" "===c?" ":""}))},getStyle:function(c,b){if(c.currentStyle)return c.currentStyle[b];if(window.getComputedStyle)return window.getComputedStyle(c,
null)[b]},getPos:function(c,b){function a(a){var b=0;var c=0;a&&(c=a.getBoundingClientRect(),a="CSS1Compat"===k.compatMode?k.documentElement:k.body,b=c.left+a.scrollLeft,c=c.top+a.scrollTop);return{x:b,y:c}}var f=0,e=0,d,k=document;b=b||k.body;if(c&&c.getBoundingClientRect&&"IE"===g.browser&&(!k.documentMode||8>k.documentMode))return f=a(c),e=a(b),{x:f.x-e.x,y:f.y-e.y};for(d=c;d&&d!=b&&d.nodeType;)f+=d.offsetLeft||0,e+=d.offsetTop||0,d=d.offsetParent;for(d=c.parentNode;d&&d!=b&&d.nodeType;)f-=d.scrollLeft||
0,e-=d.scrollTop||0,d=d.parentNode;return{x:f,y:e}},getSize:function(c){return{w:c.offsetWidth||c.clientWidth,h:c.offsetHeight||c.clientHeight}}}});n("moxie/core/EventTarget",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic"],function(g,c,d){function b(){this.uid=d.guid()}var a={};d.extend(b.prototype,{init:function(){this.uid||(this.uid=d.guid("uid_"))},addEventListener:function(b,c,m,k){var h=this;this.hasOwnProperty("uid")||(this.uid=d.guid("uid_"));b=d.trim(b);if(/\s/.test(b))d.each(b.split(/\s+/),
function(a){h.addEventListener(a,c,m,k)});else{b=b.toLowerCase();m=parseInt(m,10)||0;var e=a[this.uid]&&a[this.uid][b]||[];e.push({fn:c,priority:m,scope:k||this});a[this.uid]||(a[this.uid]={});a[this.uid][b]=e}},hasEventListener:function(b){b?(b=b.toLowerCase(),b=a[this.uid]&&a[this.uid][b]):b=a[this.uid];return b?b:!1},removeEventListener:function(b,c){var e=this,f,h;b=b.toLowerCase();if(/\s/.test(b))d.each(b.split(/\s+/),function(a){e.removeEventListener(a,c)});else if(f=a[this.uid]&&a[this.uid][b]){if(c)for(h=
f.length-1;0<=h;h--){if(f[h].fn===c){f.splice(h,1);break}}else f=[];f.length||(delete a[this.uid][b],d.isEmptyObj(a[this.uid])&&delete a[this.uid])}},removeAllEventListeners:function(){a[this.uid]&&delete a[this.uid]},dispatchEvent:function(b){var e,f={},k=!0;if("string"!==d.typeOf(b)){var h=b;if("string"===d.typeOf(h.type))b=h.type,void 0!==h.total&&void 0!==h.loaded&&(f.total=h.total,f.loaded=h.loaded),f.async=h.async||!1;else throw new c.EventException(c.EventException.UNSPECIFIED_EVENT_TYPE_ERR);
}-1!==b.indexOf("::")?function(a){e=a[0];b=a[1]}(b.split("::")):e=this.uid;b=b.toLowerCase();if(h=a[e]&&a[e][b]){h.sort(function(a,b){return b.priority-a.priority});var l=[].slice.call(arguments);l.shift();f.type=b;l.unshift(f);MXI_DEBUG&&g.debug.events&&g.log("%cEvent '%s' fired on %s","color: #999;",f.type,(this.ctorName?this.ctorName+"::":"")+e);var q=[];d.each(h,function(a){l[0].target=a.scope;f.async?q.push(function(b){setTimeout(function(){b(!1===a.fn.apply(a.scope,l))},1)}):q.push(function(b){b(!1===
a.fn.apply(a.scope,l))})});q.length&&d.inSeries(q,function(a){k=!a})}return k},bindOnce:function(a,b,c,d){var h=this;h.bind.call(this,a,function q(){h.unbind(a,q);return b.apply(this,arguments)},c,d)},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},handleEventProps:function(a){var b=
this;this.bind(a.join(" "),function(a){var b="on"+a.type.toLowerCase();"function"===d.typeOf(this[b])&&this[b].apply(this,arguments)});d.each(a,function(a){a="on"+a.toLowerCase(a);"undefined"===d.typeOf(b[a])&&(b[a]=null)})}});b.instance=new b;return b});n("moxie/runtime/Runtime",["moxie/core/utils/Env","moxie/core/utils/Basic","moxie/core/utils/Dom","moxie/core/EventTarget"],function(g,c,d,b){function a(b,f,h,l,q){var m=this,k=c.guid(f+"_");q=q||"browser";b=b||{};e[k]=this;h=c.extend({access_binary:!1,
access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},h);b.preferred_caps&&(q=a.getMode(l,b.preferred_caps,q));MXI_DEBUG&&
g.debug.runtime&&g.log("\tdefault mode: %s",q);var y=function(){var a={};return{exec:function(b,c,h,e){if(y[c]&&(a[b]||(a[b]={context:this,instance:new y[c]}),a[b].instance[h]))return a[b].instance[h].apply(this,e)},removeInstance:function(b){delete a[b]},removeAllInstances:function(){var b=this;c.each(a,function(a,h){"function"===c.typeOf(a.instance.destroy)&&a.instance.destroy.call(a.context);b.removeInstance(h)})}}}();c.extend(this,{initialized:!1,uid:k,type:f,mode:a.getMode(l,b.required_caps,
q),shimid:k+"_container",clients:0,options:b,can:function(b,e,d){d=d||h;"string"===c.typeOf(b)&&"undefined"===c.typeOf(e)&&(b=a.parseCaps(b));if("object"===c.typeOf(b)){for(var f in b)if(!this.can(f,b[f],d))return!1;return!0}return"function"===c.typeOf(d[b])?d[b].call(this,e):e===d[b]},getShimContainer:function(){var a=d.get(this.shimid);if(!a){var b=d.get(this.options.container)||document.body;a=document.createElement("div");a.id=this.shimid;a.className="moxie-shim moxie-shim-"+this.type;c.extend(a.style,
{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"});b.appendChild(a)}return a},getShim:function(){return y},shimExec:function(a,b){var c=[].slice.call(arguments,2);return m.getShim().exec.call(this,this.uid,a,b,c)},exec:function(a,b){var c=[].slice.call(arguments,2);return m[a]&&m[a][b]?m[a][b].apply(this,c):m.shimExec.apply(this,arguments)},destroy:function(){if(m){var a=d.get(this.shimid);a&&a.parentNode.removeChild(a);y&&y.removeAllInstances();this.unbindAll();
delete e[this.uid];k=m=y=this.uid=null}}});this.mode&&b.required_caps&&!this.can(b.required_caps)&&(this.mode=!1)}var f={},e={};a.order="html5,flash,silverlight,html4";a.getRuntime=function(a){return e[a]?e[a]:!1};a.addConstructor=function(a,c){c.prototype=b.instance;f[a]=c};a.getConstructor=function(a){return f[a]||null};a.getInfo=function(b){var c=a.getRuntime(b);return c?{uid:c.uid,type:c.type,mode:c.mode,can:function(){return c.can.apply(c,arguments)}}:null};a.parseCaps=function(a){var b={};if("string"!==
c.typeOf(a))return a||{};c.each(a.split(","),function(a){b[a]=!0});return b};a.can=function(b,c){var h=a.getConstructor(b);if(h){h=new h({required_caps:c});var e=h.mode;h.destroy();return!!e}return!1};a.thatCan=function(b,c){var h=(c||a.order).split(/\s*,\s*/),e;for(e in h)if(a.can(h[e],b))return h[e];return null};a.getMode=function(a,b,e){var h=null;"undefined"===c.typeOf(e)&&(e="browser");if(b&&!c.isEmptyObj(a)){c.each(b,function(b,e){if(a.hasOwnProperty(e)){var d=a[e](b);"string"===typeof d&&(d=
[d]);if(!h)h=d;else if(!(h=c.arrayIntersect(h,d)))return MXI_DEBUG&&g.debug.runtime&&g.log("\t\t%s: %s (conflicting mode requested: %s)",e,b,d),h=!1}MXI_DEBUG&&g.debug.runtime&&g.log("\t\t%s: %s (compatible modes: %s)",e,b,h)});if(h)return-1!==c.inArray(e,h)?e:h[0];if(!1===h)return!1}return e};a.getGlobalEventTarget=function(){if(/^moxie\./.test(g.global_event_dispatcher)&&!g.can("access_global_ns")){var a=c.guid("moxie_event_target_");window[a]=function(a,c){b.instance.dispatchEvent(a,c)};g.global_event_dispatcher=
a}return g.global_event_dispatcher};a.capTrue=function(){return!0};a.capFalse=function(){return!1};a.capTest=function(a){return function(){return!!a}};return a});n("moxie/runtime/RuntimeClient",["moxie/core/utils/Env","moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/Runtime"],function(g,c,d,b){return function(){var a;d.extend(this,{connectRuntime:function(f){function e(h){var d;if(h.length){var k=h.shift().toLowerCase();(d=b.getConstructor(k))?(MXI_DEBUG&&g.debug.runtime&&(g.log("Trying runtime: %s",
k),g.log(f)),a=new d(f),a.bind("Init",function(){a.initialized=!0;MXI_DEBUG&&g.debug.runtime&&g.log("Runtime '%s' initialized",a.type);setTimeout(function(){a.clients++;m.ruid=a.uid;m.trigger("RuntimeInit",a)},1)}),a.bind("Error",function(){MXI_DEBUG&&g.debug.runtime&&g.log("Runtime '%s' failed to initialize",a.type);a.destroy();e(h)}),a.bind("Exception",function(a,b){var e=b.name+"(#"+b.code+")"+(b.message?", from: "+b.message:"");MXI_DEBUG&&g.debug.runtime&&g.log("Runtime '%s' has thrown an exception: %s",
this.type,e);m.trigger("RuntimeError",new c.RuntimeError(c.RuntimeError.EXCEPTION_ERR,e))}),MXI_DEBUG&&g.debug.runtime&&g.log("\tselected mode: %s",a.mode),a.mode?a.init():a.trigger("Error")):(MXI_DEBUG&&g.debug.runtime&&g.log("Constructor for '%s' runtime is not available.",k),e(h))}else m.trigger("RuntimeError",new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR)),a=null}var m=this;if("string"===d.typeOf(f))var k=f;else"string"===d.typeOf(f.ruid)&&(k=f.ruid);if(k){if(a=b.getRuntime(k))return m.ruid=
k,a.clients++,a;throw new c.RuntimeError(c.RuntimeError.NOT_INIT_ERR);}e((f.runtime_order||b.order).split(/\s*,\s*/))},disconnectRuntime:function(){a&&0>=--a.clients&&a.destroy();a=null},getRuntime:function(){return a&&a.uid?a:a=null},exec:function(){return a?a.exec.apply(this,arguments):null},can:function(b){return a?a.can(b):!1}})}});n("moxie/file/Blob",["moxie/core/utils/Basic","moxie/core/utils/Encode","moxie/runtime/RuntimeClient"],function(g,c,d){function b(f,e){function m(c,e,d){var h=a[this.uid];
if("string"!==g.typeOf(h)||!h.length)return null;e=new b(null,{type:d,size:e-c});e.detach(h.substr(c,e.size));return e}d.call(this);f&&this.connectRuntime(f);e?"string"===g.typeOf(e)&&(e={data:e}):e={};g.extend(this,{uid:e.uid||g.guid("uid_"),ruid:f,size:e.size||0,type:e.type||"",slice:function(a,b,c){return this.isDetached()?m.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),a,b,c)},getSource:function(){return a[this.uid]?a[this.uid]:null},detach:function(b){this.ruid&&
(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null);b=b||"";if("data:"==b.substr(0,5)){var e=b.indexOf(";base64,");this.type=b.substring(5,e);b=c.atob(b.substring(e+8))}this.size=b.length;a[this.uid]=b},isDetached:function(){return!this.ruid&&"string"===g.typeOf(a[this.uid])},destroy:function(){this.detach();delete a[this.uid]}});e.data?this.detach(e.data):a[this.uid]=e}var a={};return b});n("moxie/core/I18n",["moxie/core/utils/Basic"],function(g){var c={};
return{addI18n:function(d){return g.extend(c,d)},translate:function(d){return c[d]||d},_:function(c){return this.translate(c)},sprintf:function(c){var b=[].slice.call(arguments,1);return c.replace(/%[a-z]/g,function(){var a=b.shift();return"undefined"!==g.typeOf(a)?a:""})}}});n("moxie/core/utils/Mime",["moxie/core/utils/Basic","moxie/core/I18n"],function(g,c){var d={},b={},a=function(a){a=a.split(/,/);var c,e;for(c=0;c<a.length;c+=2){var f=a[c+1].split(/ /);for(e=0;e<f.length;e++)d[f[e]]=a[c];b[a[c]]=
f}},f=function(a){var c=[];g.each(a,function(a){a=a.toLowerCase();if("*"===a)return c=[],!1;var e=a.match(/^(\w+)\/(\*|\w+)$/);e&&("*"===e[2]?g.each(b,function(a,h){(new RegExp("^"+e[1]+"/")).test(h)&&[].push.apply(c,b[h])}):b[a]&&[].push.apply(c,b[a]))});return c},e=function(a){return(a=a&&a.match(/\.([^.]+)$/))?a[1].toLowerCase():""};a("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb xlt xla,application/vnd.ms-powerpoint,ppt pps pot ppa,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");
return{mimes:d,extensions:b,addMimeType:a,extList2mimes:function(a,b){var c,e,d=[];for(c=0;c<a.length;c++){var f=a[c].extensions.toLowerCase().split(/\s*,\s*/);for(e=0;e<f.length;e++){if("*"===f[e])return[];var m=d[f[e]];if(b&&/^\w+$/.test(f[e]))d.push("."+f[e]);else if(m&&-1===g.inArray(m,d))d.push(m);else if(!m)return[]}}return d},mimes2exts:f,mimes2extList:function(a){var b=[];"string"===g.typeOf(a)&&(a=g.trim(a).split(/\s*,\s*/));a=f(a);b.push({title:c.translate("Files"),extensions:a.length?a.join(","):
"*"});return b},getFileExtension:e,getFileMime:function(a){return d[e(a)]||""}}});n("moxie/file/FileInput","moxie/core/utils/Basic moxie/core/utils/Env moxie/core/utils/Mime moxie/core/utils/Dom moxie/core/Exceptions moxie/core/EventTarget moxie/core/I18n moxie/runtime/Runtime moxie/runtime/RuntimeClient".split(" "),function(g,c,d,b,a,f,e,m,k){function h(h){MXI_DEBUG&&c.log("Instantiating FileInput...");-1!==g.inArray(g.typeOf(h),["string","node"])&&(h={browse_button:h});var f=b.get(h.browse_button);
if(!f)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);f={accept:[{title:e.translate("All Files"),extensions:"*"}],multiple:!1,required_caps:!1,container:f.parentNode||document.body};h=g.extend({},f,h);"string"===typeof h.required_caps&&(h.required_caps=m.parseCaps(h.required_caps));"string"===typeof h.accept&&(h.accept=d.mimes2extList(h.accept));f=b.get(h.container);f||(f=document.body);"static"===b.getStyle(f,"position")&&(f.style.position="relative");f=f=null;k.call(this);g.extend(this,{uid:g.guid("uid_"),
ruid:null,shimid:null,files:null,init:function(){var a=this;a.bind("RuntimeInit",function(c,e){a.ruid=e.uid;a.shimid=e.shimid;a.bind("Ready",function(){a.trigger("Refresh")},999);a.bind("Refresh",function(){var a=b.get(h.browse_button);var c=b.get(e.shimid);if(a){var d=b.getPos(a,b.get(h.container));var f=b.getSize(a);a=parseInt(b.getStyle(a,"z-index"),10)||0;c&&g.extend(c.style,{top:d.y+"px",left:d.x+"px",width:f.w+"px",height:f.h+"px",zIndex:a+1})}});e.exec.call(a,"FileInput","init",h)});a.connectRuntime(g.extend({},
h,{required_caps:{select_file:!0}}))},getOption:function(a){return h[a]},setOption:function(b,c){if(h.hasOwnProperty(b)){var e=h[b];switch(b){case "accept":"string"===typeof c&&(c=d.mimes2extList(c));break;case "container":case "required_caps":throw new a.FileException(a.FileException.NO_MODIFICATION_ALLOWED_ERR);}h[b]=c;this.exec("FileInput","setOption",b,c);this.trigger("OptionChanged",b,c,e)}},disable:function(a){this.getRuntime()&&this.exec("FileInput","disable","undefined"===g.typeOf(a)?!0:a)},
refresh:function(){this.trigger("Refresh")},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileInput","destroy"),this.disconnectRuntime());"array"===g.typeOf(this.files)&&g.each(this.files,function(a){a.destroy()});this.files=null;this.unbindAll()}});this.handleEventProps(l)}var l="ready change cancel mouseenter mouseleave mousedown mouseup".split(" ");h.prototype=f.instance;return h});n("moxie/file/File",["moxie/core/utils/Basic","moxie/core/utils/Mime","moxie/file/Blob"],function(g,
c,d){function b(a,b){b||(b={});d.apply(this,arguments);this.type||(this.type=c.getFileMime(b.name));if(b.name){var e=b.name.replace(/\\/g,"/");e=e.substr(e.lastIndexOf("/")+1)}else this.type&&(e=this.type.split("/")[0],e=g.guid((""!==e?e:"file")+"_"),c.extensions[this.type]&&(e+="."+c.extensions[this.type][0]));g.extend(this,{name:e||g.guid("file_"),relativePath:"",lastModifiedDate:b.lastModified?new Date(b.lastModified):b.lastModifiedDate||(new Date).toLocaleString()})}b.prototype=d.prototype;return b});
n("moxie/file/FileDrop","moxie/core/I18n moxie/core/utils/Dom moxie/core/Exceptions moxie/core/utils/Basic moxie/core/utils/Env moxie/file/File moxie/runtime/RuntimeClient moxie/core/EventTarget moxie/core/utils/Mime".split(" "),function(g,c,d,b,a,f,e,m,k){function h(h){MXI_DEBUG&&a.log("Instantiating FileDrop...");var d=this;"string"===typeof h&&(h={drop_zone:h});var f={accept:[{title:g.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}};h="object"===typeof h?b.extend({},f,
h):f;h.container=c.get(h.drop_zone)||document.body;"static"===c.getStyle(h.container,"position")&&(h.container.style.position="relative");"string"===typeof h.accept&&(h.accept=k.mimes2extList(h.accept));e.call(d);b.extend(d,{uid:b.guid("uid_"),ruid:null,files:null,init:function(){d.bind("RuntimeInit",function(a,b){d.ruid=b.uid;b.exec.call(d,"FileDrop","init",h);d.dispatchEvent("ready")});d.connectRuntime(h)},destroy:function(){var a=this.getRuntime();a&&(a.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime());
this.files=null;this.unbindAll()}});this.handleEventProps(l)}var l=["ready","dragenter","dragleave","drop","error"];h.prototype=m.instance;return h});n("moxie/file/FileReader","moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/Exceptions moxie/core/EventTarget moxie/file/Blob moxie/runtime/RuntimeClient".split(" "),function(g,c,d,b,a,f){function e(){function b(b,f){this.trigger("loadstart");if(this.readyState===e.LOADING)this.trigger("error",new d.DOMException(d.DOMException.INVALID_STATE_ERR)),
this.trigger("loadend");else if(f instanceof a)if(this.result=null,this.readyState=e.LOADING,f.isDetached()){var h=f.getSource();switch(b){case "readAsText":case "readAsBinaryString":this.result=h;break;case "readAsDataURL":this.result="data:"+f.type+";base64,"+c.btoa(h)}this.readyState=e.DONE;this.trigger("load");this.trigger("loadend")}else this.connectRuntime(f.ruid),this.exec("FileReader","read",b,f);else this.trigger("error",new d.DOMException(d.DOMException.NOT_FOUND_ERR)),this.trigger("loadend")}
f.call(this);g.extend(this,{uid:g.guid("uid_"),readyState:e.EMPTY,result:null,error:null,readAsBinaryString:function(a){b.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){b.call(this,"readAsDataURL",a)},readAsText:function(a){b.call(this,"readAsText",a)},abort:function(){this.result=null;-1===g.inArray(this.readyState,[e.EMPTY,e.DONE])&&(this.readyState===e.LOADING&&(this.readyState=e.DONE),this.exec("FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort();
this.exec("FileReader","destroy");this.disconnectRuntime();this.unbindAll()}});this.handleEventProps(m);this.bind("Error",function(a,b){this.readyState=e.DONE;this.error=b},999);this.bind("Load",function(a){this.readyState=e.DONE},999)}var m="loadstart progress load abort error loadend".split(" ");e.EMPTY=0;e.LOADING=1;e.DONE=2;e.prototype=b.instance;return e});n("moxie/core/utils/Url",["moxie/core/utils/Basic"],function(g){var c=function(d,b){var a="source scheme authority userInfo user pass host port relative path directory file query fragment".split(" "),
f=a.length,e={http:80,https:443},m={},k=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@\/]*):?([^:@\/]*))?@)?(\[[\da-fA-F:]+\]|[^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(d||""),h=/^\/\/\w/.test(d);switch(g.typeOf(b)){case "undefined":b=c(document.location.href,!1);break;case "string":b=c(b,!1)}for(;f--;)k[f]&&(m[a[f]]=k[f]);a=!h&&!m.scheme;if(h||a)m.scheme=b.scheme;a&&(m.host=b.host,m.port=b.port,h="",/^[^\/]/.test(m.path)&&(h=b.path,h=/\/[^\/]*\.[^\/]*$/.test(h)?
h.replace(/\/[^\/]+$/,"/"):h.replace(/\/?$/,"/")),m.path=h+(m.path||""));m.port||(m.port=e[m.scheme]||80);m.port=parseInt(m.port,10);m.path||(m.path="/");delete m.source;return m};return{parseUrl:c,resolveUrl:function(d){d="object"===typeof d?d:c(d);return d.scheme+"://"+d.host+(d.port!=={http:80,https:443}[d.scheme]?":"+d.port:"")+d.path+(d.query?d.query:"")},hasSameOrigin:function(d){function b(a){return[a.scheme,a.host,a.port].join("/")}"string"===typeof d&&(d=c(d));return b(c())===b(d)}}});n("moxie/runtime/RuntimeTarget",
["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(g,c,d){function b(){this.uid=g.guid("uid_");c.call(this);this.destroy=function(){this.disconnectRuntime();this.unbindAll()}}b.prototype=d.instance;return b});n("moxie/file/FileReaderSync",["moxie/core/utils/Basic","moxie/runtime/RuntimeClient","moxie/core/utils/Encode"],function(g,c,d){return function(){function b(a,b){if(b.isDetached()){var c=b.getSource();switch(a){case "readAsBinaryString":return c;case "readAsDataURL":return"data:"+
b.type+";base64,"+d.btoa(c);case "readAsText":for(var f="",k=0,h=c.length;k<h;k++)f+=String.fromCharCode(c[k]);return f}}else return c=this.connectRuntime(b.ruid).exec.call(this,"FileReaderSync","read",a,b),this.disconnectRuntime(),c}c.call(this);g.extend(this,{uid:g.guid("uid_"),readAsBinaryString:function(a){return b.call(this,"readAsBinaryString",a)},readAsDataURL:function(a){return b.call(this,"readAsDataURL",a)},readAsText:function(a){return b.call(this,"readAsText",a)}})}});n("moxie/xhr/FormData",
["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/file/Blob"],function(g,c,d){return function(){var b,a=[];c.extend(this,{append:function(f,e){var m=this,k=c.typeOf(e);e instanceof d?b={name:f,value:e}:"array"===k?(f+="[]",c.each(e,function(a){m.append(f,a)})):"object"===k?c.each(e,function(a,b){m.append(f+"["+b+"]",a)}):"null"===k||"undefined"===k||"number"===k&&isNaN(e)?m.append(f,"false"):a.push({name:f,value:e.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return b&&
b.value||null},getBlobName:function(){return b&&b.name||null},each:function(d){c.each(a,function(a){d(a.value,a.name)});b&&d(b.value,b.name)},destroy:function(){b=null;a=[]}})}});n("moxie/xhr/XMLHttpRequest","moxie/core/utils/Basic moxie/core/Exceptions moxie/core/EventTarget moxie/core/utils/Encode moxie/core/utils/Url moxie/runtime/Runtime moxie/runtime/RuntimeTarget moxie/file/Blob moxie/file/FileReaderSync moxie/xhr/FormData moxie/core/utils/Env moxie/core/utils/Mime".split(" "),function(g,c,
d,b,a,f,e,m,k,h,l,q){function r(){this.uid=g.guid("uid_")}function p(){function d(a,b){if(v.hasOwnProperty(a)){if(1===arguments.length)return l.can("define_property")?v[a]:u[a];l.can("define_property")?v[a]=b:u[a]=b}}function k(a){function b(){C&&(C.destroy(),C=null);l.dispatchEvent("loadend");l=null}function c(c){C.bind("LoadStart",function(a){d("readyState",p.LOADING);l.dispatchEvent("readystatechange");l.dispatchEvent(a);N&&l.upload.dispatchEvent(a)});C.bind("Progress",function(a){d("readyState")!==
p.LOADING&&(d("readyState",p.LOADING),l.dispatchEvent("readystatechange"));l.dispatchEvent(a)});C.bind("UploadProgress",function(a){N&&l.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:a.total,loaded:a.loaded})});C.bind("Load",function(a){d("readyState",p.DONE);d("status",Number(c.exec.call(C,"XMLHttpRequest","getStatus")||0));d("statusText",y[d("status")]||"");d("response",c.exec.call(C,"XMLHttpRequest","getResponse",d("responseType")));~g.inArray(d("responseType"),["text",""])?d("responseText",
d("response")):"document"===d("responseType")&&d("responseXML",d("response"));w=c.exec.call(C,"XMLHttpRequest","getAllResponseHeaders");l.dispatchEvent("readystatechange");0<d("status")?(N&&l.upload.dispatchEvent(a),l.dispatchEvent(a)):(t=!0,l.dispatchEvent("error"));b()});C.bind("Abort",function(a){l.dispatchEvent(a);b()});C.bind("Error",function(a){t=!0;d("readyState",p.DONE);l.dispatchEvent("readystatechange");O=!0;l.dispatchEvent(a);b()});c.exec.call(C,"XMLHttpRequest","send",{url:A,method:R,
async:B,user:G,password:J,headers:n,mimeType:H,encoding:I,responseType:l.responseType,withCredentials:l.withCredentials,options:F},a)}var l=this;(new Date).getTime();C=new e;"string"===typeof F.required_caps&&(F.required_caps=f.parseCaps(F.required_caps));F.required_caps=g.extend({},F.required_caps,{return_response_type:l.responseType});a instanceof h&&(F.required_caps.send_multipart=!0);g.isEmptyObj(n)||(F.required_caps.send_custom_headers=!0);P||(F.required_caps.do_cors=!0);F.ruid?c(C.connectRuntime(F)):
(C.bind("RuntimeInit",function(a,b){c(b)}),C.bind("RuntimeError",function(a,b){l.dispatchEvent("RuntimeError",b)}),C.connectRuntime(F))}var u=this,v={timeout:0,readyState:p.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},B=!0,A,R,n={},G,J,I=null,H=null,Q=!1,L=!1,N=!1,O=!1,t=!1,P=!1,F={},C,w="",K;g.extend(this,v,{uid:g.guid("uid_"),upload:new r,open:function(e,h,f,l,m){if(!e||!h)throw new c.DOMException(c.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(e)||
b.utf8_encode(e)!==e)throw new c.DOMException(c.DOMException.SYNTAX_ERR);~g.inArray(e.toUpperCase(),"CONNECT DELETE GET HEAD OPTIONS POST PUT TRACE TRACK".split(" "))&&(R=e.toUpperCase());if(~g.inArray(R,["CONNECT","TRACE","TRACK"]))throw new c.DOMException(c.DOMException.SECURITY_ERR);h=b.utf8_encode(h);e=a.parseUrl(h);P=a.hasSameOrigin(e);A=a.resolveUrl(h);if((l||m)&&!P)throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);G=l||e.user;J=m||e.pass;B=f||!0;if(!1===B&&(d("timeout")||d("withCredentials")||
""!==d("responseType")))throw new c.DOMException(c.DOMException.INVALID_ACCESS_ERR);Q=!B;L=!1;n={};d("responseText","");d("responseXML",null);d("response",null);d("status",0);d("statusText","");d("readyState",p.OPENED);this.dispatchEvent("readystatechange")},setRequestHeader:function(a,e){if(d("readyState")!==p.OPENED||L)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(a)||b.utf8_encode(a)!==a)throw new c.DOMException(c.DOMException.SYNTAX_ERR);a=g.trim(a).toLowerCase();
if(~g.inArray(a,"accept-charset accept-encoding access-control-request-headers access-control-request-method connection content-length cookie cookie2 content-transfer-encoding date expect host keep-alive origin referer te trailer transfer-encoding upgrade user-agent via".split(" "))||/^(proxy\-|sec\-)/.test(a))return!1;n[a]=n[a]?n[a]+(", "+e):e;return!0},hasRequestHeader:function(a){return a&&n[a.toLowerCase()]||!1},getAllResponseHeaders:function(){return w||""},getResponseHeader:function(a){a=a.toLowerCase();
return t||~g.inArray(a,["set-cookie","set-cookie2"])?null:w&&""!==w&&(K||(K={},g.each(w.split(/\r\n/),function(a){a=a.split(/:\s+/);2===a.length&&(a[0]=g.trim(a[0]),K[a[0].toLowerCase()]={header:a[0],value:g.trim(a[1])})})),K.hasOwnProperty(a))?K[a].header+": "+K[a].value:null},overrideMimeType:function(a){var b;if(~g.inArray(d("readyState"),[p.LOADING,p.DONE]))throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);a=g.trim(a.toLowerCase());/;/.test(a)&&(b=a.match(/^([^;]+)(?:;\scharset=)?(.*)$/))&&
(a=b[1]);if(!q.mimes[a])throw new c.DOMException(c.DOMException.SYNTAX_ERR);},send:function(a,e){F="string"===g.typeOf(e)?{ruid:e}:e?e:{};if(this.readyState!==p.OPENED||L)throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);if(a instanceof m)F.ruid=a.ruid,H=a.type||"application/octet-stream";else if(a instanceof h){if(a.hasBlob()){var d=a.getBlob();F.ruid=d.ruid;H=d.type||"application/octet-stream"}}else"string"===typeof a&&(I="UTF-8",H="text/plain;charset=UTF-8",a=b.utf8_encode(a));this.withCredentials||
(this.withCredentials=F.required_caps&&F.required_caps.send_browser_cookies&&!P);N=!Q&&this.upload.hasEventListener();t=!1;O=!a;Q||(L=!0);k.call(this,a)},abort:function(){t=!0;Q=!1;if(~g.inArray(d("readyState"),[p.UNSENT,p.OPENED,p.DONE]))d("readyState",p.UNSENT);else{d("readyState",p.DONE);L=!1;if(C)C.getRuntime().exec.call(C,"XMLHttpRequest","abort",O);else throw new c.DOMException(c.DOMException.INVALID_STATE_ERR);O=!0}},destroy:function(){C&&("function"===g.typeOf(C.destroy)&&C.destroy(),C=null);
this.unbindAll();this.upload&&(this.upload.unbindAll(),this.upload=null)}});this.handleEventProps(z.concat(["readystatechange"]));this.upload.handleEventProps(z)}var y={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",
306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",
426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};r.prototype=d.instance;var z="loadstart progress abort error load timeout loadend".split(" ");p.UNSENT=0;p.OPENED=1;p.HEADERS_RECEIVED=2;p.LOADING=3;p.DONE=4;p.prototype=d.instance;return p});n("moxie/runtime/Transporter",["moxie/core/utils/Basic","moxie/core/utils/Encode",
"moxie/runtime/RuntimeClient","moxie/core/EventTarget"],function(g,c,d,b){function a(){function b(b,c){var d=this;k=c;d.bind("TransportingProgress",function(b){q=b.loaded;q<l&&-1===g.inArray(d.state,[a.IDLE,a.DONE])&&e.call(d)},999);d.bind("TransportingComplete",function(){q=l;d.state=a.DONE;h=null;d.result=k.exec.call(d,"Transporter","getAsBlob",b||"")},999);d.state=a.BUSY;d.trigger("TransportingStarted");e.call(d)}function e(){var a=l-q;r>a&&(r=a);a=c.btoa(h.substr(q,r));k.exec.call(this,"Transporter",
"receive",a,l)}var m,k,h,l,q,r;d.call(this);g.extend(this,{uid:g.guid("uid_"),state:a.IDLE,result:null,transport:function(a,c,e){var d=this;e=g.extend({chunk_size:204798},e);if(m=e.chunk_size%3)e.chunk_size+=3-m;r=e.chunk_size;l=q=0;h=this.result=null;h=a;l=a.length;if("string"===g.typeOf(e)||e.ruid)b.call(d,c,this.connectRuntime(e));else{var f=function(a,e){d.unbind("RuntimeInit",f);b.call(d,c,e)};this.bind("RuntimeInit",f);this.connectRuntime(e)}},abort:function(){this.state=a.IDLE;k&&(k.exec.call(this,
"Transporter","clear"),this.trigger("TransportingAborted"));l=q=0;h=this.result=null},destroy:function(){this.unbindAll();k=null;this.disconnectRuntime();l=q=0;h=this.result=null}})}a.IDLE=0;a.BUSY=1;a.DONE=2;a.prototype=b.instance;return a});n("moxie/image/Image","moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/Exceptions moxie/file/FileReaderSync moxie/xhr/XMLHttpRequest moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/runtime/Transporter moxie/core/utils/Env moxie/core/EventTarget moxie/file/Blob moxie/file/File moxie/core/utils/Encode".split(" "),
function(g,c,d,b,a,f,e,m,k,h,l,q,r){function p(){function b(a){var c=g.typeOf(a);try{if(a instanceof p){if(!a.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);h.apply(this,arguments)}else if(a instanceof l){if(!~g.inArray(a.type,["image/jpeg","image/png"]))throw new d.ImageError(d.ImageError.WRONG_FORMAT);M.apply(this,arguments)}else if(-1!==g.inArray(c,["blob","file"]))b.call(this,new q(null,a),arguments[1]);else if("string"===c)"data:"===a.substr(0,5)?b.call(this,new l(null,{data:a}),
arguments[1]):u.apply(this,arguments);else if("node"===c&&"img"===a.nodeName.toLowerCase())b.call(this,a.src,arguments[1]);else throw new d.DOMException(d.DOMException.TYPE_MISMATCH_ERR);}catch(A){this.trigger("error",A.code)}}function h(a,b){var c=this.connectRuntime(a.ruid);this.ruid=c.uid;c.exec.call(this,"Image","loadFromImage",a,"undefined"===g.typeOf(b)?!0:b)}function M(a,b){function c(b){e.ruid=b.uid;b.exec.call(e,"Image","loadFromBlob",a)}var e=this;e.name=a.name||"";a.isDetached()?(this.bind("RuntimeInit",
function(a,b){c(b)}),b&&"string"===typeof b.required_caps&&(b.required_caps=f.parseCaps(b.required_caps)),this.connectRuntime(g.extend({required_caps:{access_image_binary:!0,resize_image:!0}},b))):c(this.connectRuntime(a.ruid))}function u(b,c){var e=this;var d=new a;d.open("get",b);d.responseType="blob";d.onprogress=function(a){e.trigger(a)};d.onload=function(){M.call(e,d.response,!0)};d.onerror=function(a){e.trigger(a)};d.onloadend=function(){d.destroy()};d.bind("RuntimeError",function(a,b){e.trigger("RuntimeError",
b)});d.send(null,c)}e.call(this);g.extend(this,{uid:g.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){b.apply(this,arguments)},resize:function(a){var b={x:0,y:0,width:this.width,height:this.height},c=g.extendIf({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,resample:"default",multipass:!0},a);try{if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);
if(this.width>p.MAX_RESIZE_WIDTH||this.height>p.MAX_RESIZE_HEIGHT)throw new d.ImageError(d.ImageError.MAX_RESOLUTION_ERR);var e=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;if(-1!==g.inArray(e,[5,6,7,8])){var h=c.width;c.width=c.height;c.height=h}if(c.crop){var f=Math.max(c.width/this.width,c.height/this.height);a.fit?(b.width=Math.min(Math.ceil(c.width/f),this.width),b.height=Math.min(Math.ceil(c.height/f),this.height),f=c.width/b.width):(b.width=Math.min(c.width,this.width),b.height=
Math.min(c.height,this.height),f=1);"boolean"===typeof c.crop&&(c.crop="cc");switch(c.crop.toLowerCase().replace(/_/,"-")){case "rb":case "right-bottom":b.x=this.width-b.width;b.y=this.height-b.height;break;case "cb":case "center-bottom":b.x=Math.floor((this.width-b.width)/2);b.y=this.height-b.height;break;case "lb":case "left-bottom":b.x=0;b.y=this.height-b.height;break;case "lt":case "left-top":b.x=0;b.y=0;break;case "ct":case "center-top":b.x=Math.floor((this.width-b.width)/2);b.y=0;break;case "rt":case "right-top":b.x=
this.width-b.width;b.y=0;break;case "rc":case "right-center":case "right-middle":b.x=this.width-b.width;b.y=Math.floor((this.height-b.height)/2);break;case "lc":case "left-center":case "left-middle":b.x=0;b.y=Math.floor((this.height-b.height)/2);break;default:b.x=Math.floor((this.width-b.width)/2),b.y=Math.floor((this.height-b.height)/2)}b.x=Math.max(b.x,0);b.y=Math.max(b.y,0)}else f=Math.min(c.width/this.width,c.height/this.height),1<f&&!c.fit&&(f=1);this.exec("Image","resize",b,f,c)}catch(J){this.trigger("error",
J.code)}},downsize:function(a,b,c,e){var d={width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,crop:!1,fit:!1,preserveHeaders:!0,resample:"default"};a="object"===typeof a?g.extend(d,a):g.extend(d,{width:a,height:b,crop:c,preserveHeaders:e});this.resize(a)},crop:function(a,b,c){this.downsize(a,b,!0,c)},getAsCanvas:function(){if(!k.can("create_canvas"))throw new d.RuntimeError(d.RuntimeError.NOT_SUPPORTED_ERR);return this.exec("Image","getAsCanvas")},getAsBlob:function(a,b){if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);
return this.exec("Image","getAsBlob",a||"image/jpeg",b||90)},getAsDataURL:function(a,b){if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);return this.exec("Image","getAsDataURL",a||"image/jpeg",b||90)},getAsBinaryString:function(a,b){var c=this.getAsDataURL(a,b);return r.atob(c.substring(c.indexOf("base64,")+7))},embed:function(a,b){function e(b,c){var e=this;if(k.can("create_canvas")){var l=e.getAsCanvas();if(l){a.appendChild(l);l=null;e.destroy();h.trigger("embedded");return}}l=
e.getAsDataURL(b,c);if(!l)throw new d.ImageError(d.ImageError.WRONG_FORMAT);if(k.can("use_data_uri_of",l.length))a.innerHTML='<img src="'+l+'" width="'+e.width+'" height="'+e.height+'" alt="" />',e.destroy(),h.trigger("embedded");else{var q=new m;q.bind("TransportingComplete",function(){f=h.connectRuntime(this.result.ruid);h.bind("Embedded",function(){g.extend(f.getShimContainer().style,{top:"0px",left:"0px",width:e.width+"px",height:e.height+"px"});f=null},999);f.exec.call(h,"ImageView","display",
this.result.uid,width,height);e.destroy()});q.transport(r.atob(l.substring(l.indexOf("base64,")+7)),b,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:a})}}var h=this,f,l=g.extend({width:this.width,height:this.height,type:this.type||"image/jpeg",quality:90,fit:!0,resample:"nearest"},b);try{if(!(a=c.get(a)))throw new d.DOMException(d.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new d.DOMException(d.DOMException.INVALID_STATE_ERR);var q=new p;q.bind("Resize",
function(){e.call(this,l.type,l.quality)});q.bind("Load",function(){this.downsize(l)});this.meta.thumb&&this.meta.thumb.width>=l.width&&this.meta.thumb.height>=l.height?q.load(this.meta.thumb.data):q.clone(this,!1);return q}catch(I){this.trigger("error",I.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime());this.meta&&this.meta.thumb&&this.meta.thumb.data.destroy();this.unbindAll()}});this.handleEventProps(y);this.bind("Load Resize",
function(){var a=void 0;try{a||(a=this.exec("Image","getInfo"));this.size=a.size;this.width=a.width;this.height=a.height;this.type=a.type;this.meta=a.meta;""===this.name&&(this.name=a.name);var b=!0}catch(A){this.trigger("error",A.code),b=!1}return b},999)}var y=["progress","load","error","resize","embedded"];p.MAX_RESIZE_WIDTH=8192;p.MAX_RESIZE_HEIGHT=8192;p.prototype=h.instance;return p});n("moxie/runtime/html5/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],
function(g,c,d,b){var a={};d.addConstructor("html5",function(c,e,m){var f=this,h=d.capTest,l=d.capTrue;m=g.extend({access_binary:h(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return f.can("access_binary")&&!!a.Image},display_media:h((b.can("create_canvas")||b.can("use_data_uri_over32kb"))&&!!w["moxie/image/Image"]),do_cors:h(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:h(function(){var a=document.createElement("div");return("draggable"in
a||"ondragstart"in a&&"ondrop"in a)&&("IE"!==b.browser||b.verComp(b.version,9,">"))}()),filter_by_extension:h(!("Chrome"===b.browser&&b.verComp(b.version,28,"<")||"IE"===b.browser&&b.verComp(b.version,10,"<")||"Safari"===b.browser&&b.verComp(b.version,11,"<=")||"Firefox"===b.browser&&b.verComp(b.version,37,"<")||"iOS"===b.os||"Android"===b.os)),return_response_headers:l,return_response_type:function(a){return"json"===a&&window.JSON?!0:b.can("return_response_type",a)},return_status_code:l,report_upload_progress:h(window.XMLHttpRequest&&
(new XMLHttpRequest).upload),resize_image:function(){return f.can("access_binary")&&b.can("create_canvas")},select_file:function(){return b.can("use_fileinput")&&window.File},select_folder:function(){return f.can("select_file")&&("Chrome"===b.browser&&b.verComp(b.version,21,">=")||"Firefox"===b.browser&&b.verComp(b.version,42,">="))},select_multiple:function(){return f.can("select_file")&&!("Safari"===b.browser&&"Windows"===b.os)&&!("iOS"===b.os&&b.verComp(b.osVersion,"7.0.0",">")&&b.verComp(b.osVersion,
"8.0.0","<"))},send_binary_string:h(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:h(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||f.can("send_binary_string")},slice_blob:h(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return f.can("slice_blob")&&f.can("send_multipart")},summon_file_dialog:function(){return f.can("select_file")&&
!("Firefox"===b.browser&&b.verComp(b.version,4,"<")||"Opera"===b.browser&&b.verComp(b.version,12,"<")||"IE"===b.browser&&b.verComp(b.version,10,"<"))},upload_filesize:l,use_http_method:l},m);d.call(this,c,e||"html5",m);g.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(f);a=f=null}}(this.destroy)});g.extend(this.getShim(),a)});return a});n("moxie/runtime/html5/file/Blob",["moxie/runtime/html5/Runtime","moxie/file/Blob"],function(g,c){return g.Blob=function(){function d(b,
a,c){var e;if(window.File.prototype.slice)try{return b.slice(),b.slice(a,c)}catch(m){return b.slice(a,c-a)}else return(e=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?e.call(b,a,c):null}this.slice=function(){return new c(this.getRuntime().uid,d.apply(this,arguments))};this.destroy=function(){this.getRuntime().getShim().removeInstance(this.uid)}}});n("moxie/core/utils/Events",["moxie/core/utils/Basic"],function(g){function c(){this.returnValue=!1}function d(){this.cancelBubble=
!0}var b={},a="moxie_"+g.guid(),f=function(c,d,f){d=d.toLowerCase();if(c[a]&&b[c[a]]&&b[c[a]][d]){var e=b[c[a]][d];for(var l=e.length-1;0<=l;l--)if(e[l].orig===f||e[l].key===f)if(c.removeEventListener?c.removeEventListener(d,e[l].func,!1):c.detachEvent&&c.detachEvent("on"+d,e[l].func),e[l].orig=null,e[l].func=null,e.splice(l,1),void 0!==f)break;e.length||delete b[c[a]][d];if(g.isEmptyObj(b[c[a]])){delete b[c[a]];try{delete c[a]}catch(q){c[a]=void 0}}}};return{addEvent:function(e,f,k,h){f=f.toLowerCase();
if(e.addEventListener){var l=k;e.addEventListener(f,l,!1)}else e.attachEvent&&(l=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=c;a.stopPropagation=d;k(a)},e.attachEvent("on"+f,l));e[a]||(e[a]=g.guid());b.hasOwnProperty(e[a])||(b[e[a]]={});e=b[e[a]];e.hasOwnProperty(f)||(e[f]=[]);e[f].push({func:l,orig:k,key:h})},removeEvent:f,removeAllEvents:function(c,d){c&&c[a]&&g.each(b[c[a]],function(a,b){f(c,b,d)})}}});n("moxie/runtime/html5/file/FileInput","moxie/runtime/html5/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),
function(g,c,d,b,a,f,e){return g.FileInput=function(){var m,k;d.extend(this,{init:function(h){var l=this,g=l.getRuntime(),r;m=h;h=f.extList2mimes(m.accept,g.can("filter_by_extension"));var p=g.getShimContainer();p.innerHTML='<input id="'+g.uid+'" type="file" style="font-size:999px;opacity:0;"'+(m.multiple&&g.can("select_multiple")?"multiple":"")+(m.directory&&g.can("select_folder")?"webkitdirectory directory":"")+(h?' accept="'+h.join(",")+'"':"")+" />";h=b.get(g.uid);d.extend(h.style,{position:"absolute",
top:0,left:0,width:"100%",height:"100%"});var y=b.get(m.browse_button);k=b.getStyle(y,"z-index")||"auto";g.can("summon_file_dialog")&&("static"===b.getStyle(y,"position")&&(y.style.position="relative"),a.addEvent(y,"click",function(a){var c=b.get(g.uid);c&&!c.disabled&&c.click();a.preventDefault()},l.uid),l.bind("Refresh",function(){r=parseInt(k,10)||1;b.get(m.browse_button).style.zIndex=r;this.getRuntime().getShimContainer().style.zIndex=r-1}));p=g.can("summon_file_dialog")?y:p;a.addEvent(p,"mouseover",
function(){l.trigger("mouseenter")},l.uid);a.addEvent(p,"mouseout",function(){l.trigger("mouseleave")},l.uid);a.addEvent(p,"mousedown",function(){l.trigger("mousedown")},l.uid);a.addEvent(b.get(m.container),"mouseup",function(){l.trigger("mouseup")},l.uid);(g.can("summon_file_dialog")?h:y).setAttribute("tabindex",-1);h.onchange=function x(){l.files=[];d.each(this.files,function(a){var b="";if(m.directory&&"."==a.name)return!0;a.webkitRelativePath&&(b="/"+a.webkitRelativePath.replace(/^\//,""));a=
new c(g.uid,a);a.relativePath=b;l.files.push(a)});if("IE"!==e.browser&&"IEMobile"!==e.browser)this.value="";else{var a=this.cloneNode(!0);this.parentNode.replaceChild(a,this);a.onchange=x}l.files.length&&l.trigger("change")};l.trigger({type:"ready",async:!0});p=null},setOption:function(a,c){var e=this.getRuntime(),d=b.get(e.uid);switch(a){case "accept":c?(e=c.mimes||f.extList2mimes(c,e.can("filter_by_extension")),d.setAttribute("accept",e.join(","))):d.removeAttribute("accept");break;case "directory":c&&
e.can("select_folder")?(d.setAttribute("directory",""),d.setAttribute("webkitdirectory","")):(d.removeAttribute("directory"),d.removeAttribute("webkitdirectory"));break;case "multiple":c&&e.can("select_multiple")?d.setAttribute("multiple",""):d.removeAttribute("multiple")}},disable:function(a){var c=this.getRuntime();if(c=b.get(c.uid))c.disabled=!!a},destroy:function(){var c=this.getRuntime(),e=c.getShim();c=c.getShimContainer();var d=m&&b.get(m.container),f=m&&b.get(m.browse_button);d&&a.removeAllEvents(d,
this.uid);f&&(a.removeAllEvents(f,this.uid),f.style.zIndex=k);c&&(a.removeAllEvents(c,this.uid),c.innerHTML="");e.removeInstance(this.uid);m=null}})}});n("moxie/runtime/html5/file/FileDrop","moxie/runtime/html5/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime".split(" "),function(g,c,d,b,a,f){return g.FileDrop=function(){function e(a){if(!a.dataTransfer||!a.dataTransfer.types)return!1;a=d.toArray(a.dataTransfer.types||[]);return-1!==
d.inArray("Files",a)||-1!==d.inArray("public.file-url",a)||-1!==d.inArray("application/x-moz-file",a)}function m(a,b){if(y.length){var e=f.getFileExtension(a.name);e=!e||-1!==d.inArray(e,y)}else e=!0;e&&(e=new c(x,a),e.relativePath=b||"",p.push(e))}function k(a){for(var b=[],c=0;c<a.length;c++)[].push.apply(b,a[c].extensions.split(/\s*,\s*/));return-1===d.inArray("*",b)?b:[]}function h(a,b){var c=[];d.each(a,function(a){var b=a.webkitGetAsEntry();b&&(b.isFile?m(a.getAsFile(),b.fullPath):c.push(b))});
c.length?l(c,b):b()}function l(a,b){var c=[];d.each(a,function(a){c.push(function(b){g(a,b)})});d.inSeries(c,function(){b()})}function g(a,b){a.isFile?a.file(function(c){m(c,a.fullPath);b()},function(){b()}):a.isDirectory?r(a,b):b()}function r(a,b){function c(a){d.readEntries(function(b){b.length?([].push.apply(e,b),c(a)):a()},a)}var e=[],d=a.createReader();c(function(){l(e,b)})}var p=[],y=[],z,x;d.extend(this,{init:function(b){var c=this;z=b;x=c.ruid;y=k(z.accept);b=z.container;a.addEvent(b,"dragover",
function(a){e(a)&&(a.preventDefault(),a.dataTransfer.dropEffect="copy")},c.uid);a.addEvent(b,"drop",function(a){e(a)&&(a.preventDefault(),p=[],a.dataTransfer.items&&a.dataTransfer.items[0].webkitGetAsEntry?h(a.dataTransfer.items,function(){c.files=p;c.trigger("drop")}):(d.each(a.dataTransfer.files,function(a){m(a)}),c.files=p,c.trigger("drop")))},c.uid);a.addEvent(b,"dragenter",function(a){c.trigger("dragenter")},c.uid);a.addEvent(b,"dragleave",function(a){c.trigger("dragleave")},c.uid)},destroy:function(){a.removeAllEvents(z&&
b.get(z.container),this.uid);x=p=y=z=null;this.getRuntime().getShim().removeInstance(this.uid)}})}});n("moxie/runtime/html5/file/FileReader",["moxie/runtime/html5/Runtime","moxie/core/utils/Encode","moxie/core/utils/Basic"],function(g,c,d){return g.FileReader=function(){var b,a=!1;d.extend(this,{read:function(f,e){var m=this;m.result="";b=new window.FileReader;b.addEventListener("progress",function(a){m.trigger(a)});b.addEventListener("load",function(e){if(a){var d=b.result;d=c.atob(d.substring(d.indexOf("base64,")+
7))}else d=b.result;m.result=d;m.trigger(e)});b.addEventListener("error",function(a){m.trigger(a,b.error)});b.addEventListener("loadend",function(a){b=null;m.trigger(a)});"function"===d.typeOf(b[f])?(a=!1,b[f](e.getSource())):"readAsBinaryString"===f&&(a=!0,b.readAsDataURL(e.getSource()))},abort:function(){b&&b.abort()},destroy:function(){b=null;this.getRuntime().getShim().removeInstance(this.uid)}})}});n("moxie/runtime/html5/xhr/XMLHttpRequest","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/utils/Mime moxie/core/utils/Url moxie/file/File moxie/file/Blob moxie/xhr/FormData moxie/core/Exceptions moxie/core/utils/Env".split(" "),
function(g,c,d,b,a,f,e,m,k){return g.XMLHttpRequest=function(){function h(a,b){var c=this;var e=b.getBlob().getSource();var d=new window.FileReader;d.onload=function(){b.append(b.getBlobName(),new f(null,{type:e.type,data:d.result}));r.send.call(c,a,b)};d.readAsBinaryString(e)}function l(){if(!window.XMLHttpRequest||"IE"===k.browser&&k.verComp(k.version,8,"<")){a:{for(var a=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],b=0;b<a.length;b++)try{var c=new ActiveXObject(a[b]);break a}catch(u){}c=void 0}return c}return new window.XMLHttpRequest}
function g(a){var b="----moxieboundary"+(new Date).getTime(),c="";if(!this.getRuntime().can("send_binary_string"))throw new m.RuntimeError(m.RuntimeError.NOT_SUPPORTED_ERR);p.setRequestHeader("Content-Type","multipart/form-data; boundary="+b);a.each(function(a,e){c=a instanceof f?c+("--"+b+'\r\nContent-Disposition: form-data; name="'+e+'"; filename="'+unescape(encodeURIComponent(a.name||"blob"))+'"\r\nContent-Type: '+(a.type||"application/octet-stream")+"\r\n\r\n"+a.getSource()+"\r\n"):c+("--"+b+
'\r\nContent-Disposition: form-data; name="'+e+'"\r\n\r\n'+unescape(encodeURIComponent(a))+"\r\n")});return c+="--"+b+"--\r\n"}var r=this,p,y;c.extend(this,{send:function(a,d){var m=this,q="Mozilla"===k.browser&&k.verComp(k.version,4,">=")&&k.verComp(k.version,7,"<"),r="Android Browser"===k.browser,z=!1;y=a.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase();p=l();p.open(a.method,a.url,a.async,a.user,a.password);if(d instanceof f)d.isDetached()&&(z=!0),d=d.getSource();else if(d instanceof e){if(d.hasBlob())if(d.getBlob().isDetached())d=
g.call(m,d),z=!0;else if((q||r)&&"blob"===c.typeOf(d.getBlob().getSource())&&window.FileReader){h.call(m,a,d);return}if(d instanceof e){var x=new window.FormData;d.each(function(a,b){a instanceof f?x.append(b,a.getSource()):x.append(b,a)});d=x}}p.upload?(a.withCredentials&&(p.withCredentials=!0),p.addEventListener("load",function(a){m.trigger(a)}),p.addEventListener("error",function(a){m.trigger(a)}),p.addEventListener("progress",function(a){m.trigger(a)}),p.upload.addEventListener("progress",function(a){m.trigger({type:"UploadProgress",
loaded:a.loaded,total:a.total})})):p.onreadystatechange=function(){switch(p.readyState){case 3:var c;try{if(b.hasSameOrigin(a.url)&&(c=p.getResponseHeader("Content-Length")||0),p.responseText)var e=p.responseText.length}catch(G){c=e=0}m.trigger({type:"progress",lengthComputable:!!c,total:parseInt(c,10),loaded:e});break;case 4:p.onreadystatechange=function(){};try{if(200<=p.status&&400>p.status){m.trigger("load");break}}catch(G){}m.trigger("error")}};c.isEmptyObj(a.headers)||c.each(a.headers,function(a,
b){p.setRequestHeader(b,a)});""!==a.responseType&&"responseType"in p&&("json"!==a.responseType||k.can("return_response_type","json")?p.responseType=a.responseType:p.responseType="text");z?p.sendAsBinary?p.sendAsBinary(d):function(){for(var a=new Uint8Array(d.length),b=0;b<d.length;b++)a[b]=d.charCodeAt(b)&255;p.send(a.buffer)}():p.send(d);m.trigger("loadstart")},getStatus:function(){try{if(p)return p.status}catch(z){}return 0},getResponse:function(b){var c=this.getRuntime();try{switch(b){case "blob":var e=
new a(c.uid,p.response),h=p.getResponseHeader("Content-Disposition");if(h){var f=h.match(/filename=(['"'])([^\1]+)\1/);f&&(y=f[2])}e.name=y;e.type||(e.type=d.getFileMime(y));return e;case "json":return k.can("return_response_type","json")?p.response:200===p.status&&window.JSON?JSON.parse(p.responseText):null;case "document":var l=p.responseXML,m=p.responseText;"IE"===k.browser&&m&&l&&!l.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(p.getResponseHeader("Content-Type"))&&(l=new window.ActiveXObject("Microsoft.XMLDOM"),
l.async=!1,l.validateOnParse=!1,l.loadXML(m));var g=l&&("IE"===k.browser&&0!==l.parseError||!l.documentElement||"parsererror"===l.documentElement.tagName)?null:l;return g;default:return""!==p.responseText?p.responseText:null}}catch(S){return null}},getAllResponseHeaders:function(){try{return p.getAllResponseHeaders()}catch(z){}return""},abort:function(){p&&p.abort()},destroy:function(){r=y=null;var a=this.getRuntime();a&&a.getShim().removeInstance(this.uid)}})}});n("moxie/runtime/html5/utils/BinaryReader",
["moxie/core/utils/Basic"],function(g){function c(a){a instanceof ArrayBuffer?d.apply(this,arguments):b.apply(this,arguments)}function d(a){var b=new DataView(a);g.extend(this,{readByteAt:function(a){return b.getUint8(a)},writeByteAt:function(a,c){b.setUint8(a,c)},SEGMENT:function(c,d,f){switch(arguments.length){case 2:return a.slice(c,c+d);case 1:return a.slice(c);case 3:if(null===f&&(f=new ArrayBuffer),f instanceof ArrayBuffer){var e=new Uint8Array(this.length()-d+f.byteLength);0<c&&e.set(new Uint8Array(a.slice(0,
c)),0);e.set(new Uint8Array(f),c);e.set(new Uint8Array(a.slice(c+d)),c+f.byteLength);this.clear();a=e.buffer;b=new DataView(a);break}default:return a}},length:function(){return a?a.byteLength:0},clear:function(){b=a=null}})}function b(a){function b(b,c,d){d=3===arguments.length?d:a.length-c-1;a=a.substr(0,c)+b+a.substr(d+c)}g.extend(this,{readByteAt:function(b){return a.charCodeAt(b)},writeByteAt:function(a,c){b(String.fromCharCode(c),a,1)},SEGMENT:function(c,d,f){switch(arguments.length){case 1:return a.substr(c);
case 2:return a.substr(c,d);case 3:b(null!==f?f:"",c,d);break;default:return a}},length:function(){return a?a.length:0},clear:function(){a=null}})}g.extend(c.prototype,{littleEndian:!1,read:function(a,b){var c,d;if(a+b>this.length())throw Error("You are trying to read outside the source boundaries.");var f=this.littleEndian?0:-8*(b-1);for(c=d=0;d<b;d++)c|=this.readByteAt(a+d)<<Math.abs(f+8*d);return c},write:function(a,b,c){var d;if(a>this.length())throw Error("You are trying to write outside the source boundaries.");
var e=this.littleEndian?0:-8*(c-1);for(d=0;d<c;d++)this.writeByteAt(a+d,b>>Math.abs(e+8*d)&255)},BYTE:function(a){return this.read(a,1)},SHORT:function(a){return this.read(a,2)},LONG:function(a){return this.read(a,4)},SLONG:function(a){a=this.read(a,4);return 2147483647<a?a-4294967296:a},CHAR:function(a){return String.fromCharCode(this.read(a,1))},STRING:function(a,b){return this.asArray("CHAR",a,b).join("")},asArray:function(a,b,c){for(var d=[],e=0;e<c;e++)d[e]=this[a](b+e);return d}});return c});
n("moxie/runtime/html5/image/JPEGHeaders",["moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(g,c){return function a(b){var f=[],e,m=0;b=new g(b);if(65496!==b.SHORT(0))throw b.clear(),new c.ImageError(c.ImageError.WRONG_FORMAT);for(e=2;e<=b.length();){var k=b.SHORT(e);if(65488<=k&&65495>=k)e+=2;else{if(65498===k||65497===k)break;m=b.SHORT(e+2)+2;65505<=k&&65519>=k&&f.push({hex:k,name:"APP"+(k&15),start:e,length:m,segment:b.SEGMENT(e,m)});e+=m}}b.clear();return{headers:f,restore:function(a){var b=
new g(a);e=65504==b.SHORT(2)?4+b.SHORT(4):2;var c=0;for(a=f.length;c<a;c++)b.SEGMENT(e,0,f[c].segment),e+=f[c].length;a=b.SEGMENT();b.clear();return a},strip:function(b){var c=new a(b);var e=c.headers;c.purge();c=new g(b);for(b=e.length;b--;)c.SEGMENT(e[b].start,e[b].length,"");b=c.SEGMENT();c.clear();return b},get:function(a){for(var b=[],c=0,e=f.length;c<e;c++)f[c].name===a.toUpperCase()&&b.push(f[c].segment);return b},set:function(a,b){var c=[],e,h;"string"===typeof b?c.push(b):c=b;var l=e=0;for(h=
f.length;l<h&&!(f[l].name===a.toUpperCase()&&(f[l].segment=c[e],f[l].length=c[e].length,e++),e>=c.length);l++);},purge:function(){this.headers=f=[]}}}});n("moxie/runtime/html5/image/ExifParser",["moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader","moxie/core/Exceptions"],function(g,c,d){function b(a){function f(a,b){var c,e={},h={1:"BYTE",7:"UNDEFINED",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",9:"SLONG",10:"SRATIONAL"},f={BYTE:1,UNDEFINED:1,ASCII:1,SHORT:2,LONG:4,RATIONAL:8,SLONG:4,
SRATIONAL:8};var l=this.SHORT(a);for(c=0;c<l;c++){var q=a+2+12*c;var r=b[this.SHORT(q)];if(r!==E){var p=h[this.SHORT(q+=2)];var n=this.LONG(q+=2);var t=f[p];if(!t)throw new d.ImageError(d.ImageError.INVALID_META_ERR);q+=4;4<t*n&&(q=this.LONG(q)+k.tiffHeader);if(q+t*n>=this.length())throw new d.ImageError(d.ImageError.INVALID_META_ERR);"ASCII"===p?e[r]=g.trim(this.STRING(q,n).replace(/\0$/,"")):(p=this.asArray(p,q,n),n=1==n?p[0]:p,m.hasOwnProperty(r)&&"object"!=typeof n?e[r]=m[r][n]:e[r]=n)}}return e}
c.call(this,a);var e={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",
41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"},thumb:{513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength"}};var m={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",
9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",
13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",
73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",
2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};var k={tiffHeader:10};var h=k.tiffHeader;var l={clear:this.clear};g.extend(this,{read:function(){try{return b.prototype.read.apply(this,
arguments)}catch(r){throw new d.ImageError(d.ImageError.INVALID_META_ERR);}},write:function(){try{return b.prototype.write.apply(this,arguments)}catch(r){throw new d.ImageError(d.ImageError.INVALID_META_ERR);}},UNDEFINED:function(){return this.BYTE.apply(this,arguments)},RATIONAL:function(a){return this.LONG(a)/this.LONG(a+4)},SRATIONAL:function(a){return this.SLONG(a)/this.SLONG(a+4)},ASCII:function(a){return this.CHAR(a)},TIFF:function(){return q||null},EXIF:function(){var a=null;if(k.exifIFD){try{a=
f.call(this,k.exifIFD,e.exif)}catch(z){return null}if(a.ExifVersion&&"array"===g.typeOf(a.ExifVersion)){for(var b=0,c="";b<a.ExifVersion.length;b++)c+=String.fromCharCode(a.ExifVersion[b]);a.ExifVersion=c}}return a},GPS:function(){var a=null;if(k.gpsIFD){try{a=f.call(this,k.gpsIFD,e.gps)}catch(p){return null}a.GPSVersionID&&"array"===g.typeOf(a.GPSVersionID)&&(a.GPSVersionID=a.GPSVersionID.join("."))}return a},thumb:function(){if(k.IFD1)try{var a=f.call(this,k.IFD1,e.thumb);if("JPEGInterchangeFormat"in
a)return this.SEGMENT(k.tiffHeader+a.JPEGInterchangeFormat,a.JPEGInterchangeFormatLength)}catch(p){}return null},setExif:function(a,b){if("PixelXDimension"!==a&&"PixelYDimension"!==a)return!1;a:{var c=a;var d=0;if("string"===typeof c){var h=e.exif;for(f in h)if(h[f]===c){c=f;break}}h=k.exifIFD;var f=this.SHORT(h);for(var l=0;l<f;l++){var m=h+12*l+2;if(this.SHORT(m)==c){d=m+8;break}}if(d){try{this.write(d,b,4)}catch(B){c=!1;break a}c=!0}else c=!1}return c},clear:function(){l.clear();a=e=m=q=k=l=null}});
if(65505!==this.SHORT(0)||"EXIF\x00"!==this.STRING(4,5).toUpperCase())throw new d.ImageError(d.ImageError.INVALID_META_ERR);this.littleEndian=18761==this.SHORT(h);if(42!==this.SHORT(h+=2))throw new d.ImageError(d.ImageError.INVALID_META_ERR);k.IFD0=k.tiffHeader+this.LONG(h+=2);var q=f.call(this,k.IFD0,e.tiff);"ExifIFDPointer"in q&&(k.exifIFD=k.tiffHeader+q.ExifIFDPointer,delete q.ExifIFDPointer);"GPSInfoIFDPointer"in q&&(k.gpsIFD=k.tiffHeader+q.GPSInfoIFDPointer,delete q.GPSInfoIFDPointer);g.isEmptyObj(q)&&
(q=null);if(h=this.LONG(k.IFD0+12*this.SHORT(k.IFD0)+2))k.IFD1=k.tiffHeader+h}b.prototype=c.prototype;return b});n("moxie/runtime/html5/image/JPEG",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/html5/image/JPEGHeaders","moxie/runtime/html5/utils/BinaryReader","moxie/runtime/html5/image/ExifParser"],function(g,c,d,b,a){return function(f){function e(a){var b=0;for(a||(a=k);b<=a.length();){var c=a.SHORT(b+=2);if(65472<=c&&65475>=c)return b+=5,{height:a.SHORT(b),width:a.SHORT(b+2)};
c=a.SHORT(b+=2);b+=c-2}return null}function m(){var a=l.thumb();if(a){var c=new b(a);var d=e(c);c.clear();if(d)return d.data=a,d}return null}var k=new b(f);if(65496!==k.SHORT(0))throw new c.ImageError(c.ImageError.WRONG_FORMAT);var h=new d(f);try{var l=new a(h.get("app1")[0])}catch(r){}var q=e.call(this);g.extend(this,{type:"image/jpeg",size:k.length(),width:q&&q.width||0,height:q&&q.height||0,setExif:function(a,b){if(!l)return!1;"object"===g.typeOf(a)?g.each(a,function(a,b){l.setExif(b,a)}):l.setExif(a,
b);h.set("app1",l.SEGMENT())},writeHeaders:function(){return arguments.length?h.restore(arguments[0]):h.restore(f)},stripHeaders:function(a){return h.strip(a)},purge:function(){l&&h&&k&&(l.clear(),h.purge(),k.clear(),q=h=l=k=null)}});l&&(this.meta={tiff:l.TIFF(),exif:l.EXIF(),gps:l.GPS(),thumb:m()})}});n("moxie/runtime/html5/image/PNG",["moxie/core/Exceptions","moxie/core/utils/Basic","moxie/runtime/html5/utils/BinaryReader"],function(g,c,d){return function(b){function a(){f&&(f.clear(),b=e=f=null)}
var f=new d(b);(function(){var a=0,b,c=[35152,20039,3338,6666];for(b=0;b<c.length;b++,a+=2)if(c[b]!=f.SHORT(a))throw new g.ImageError(g.ImageError.WRONG_FORMAT);})();var e=function(){var a=8;var b=f.LONG(a);var c=f.STRING(a+=4,4);var d=a+=4;f.LONG(a+b);return"IHDR"==c?{width:f.LONG(d),height:f.LONG(d+4)}:null}.call(this);c.extend(this,{type:"image/png",size:f.length(),width:e.width,height:e.height,purge:function(){a.call(this)}});a.call(this)}});n("moxie/runtime/html5/image/ImageInfo",["moxie/core/utils/Basic",
"moxie/core/Exceptions","moxie/runtime/html5/image/JPEG","moxie/runtime/html5/image/PNG"],function(g,c,d,b){return function(a){var f=[d,b];var e=function(){for(var b=0;b<f.length;b++)try{return new f[b](a)}catch(k){}throw new c.ImageError(c.ImageError.WRONG_FORMAT);}();g.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(a){return a},stripHeaders:function(a){return a},purge:function(){a=null}});g.extend(this,e);this.purge=function(){e.purge();e=null}}});n("moxie/runtime/html5/image/ResizerCanvas",
[],function(){function g(c,d,b){var a=c.width>c.height?"width":"height",f=Math.round(c[a]*d),e=!1;"nearest"!==b&&(.5>d||2<d)&&(d=.5>d?.5:2,e=!0);var m=c.width,k=c.height,h=Math.round(m*d);d=Math.round(k*d);var l=document.createElement("canvas");l.width=h;l.height=d;l.getContext("2d").drawImage(c,0,0,m,k,0,0,h,d);return e?g(l,f/l[a],b):l}return{scale:g}});n("moxie/runtime/html5/image/Image","moxie/runtime/html5/Runtime moxie/core/utils/Basic moxie/core/Exceptions moxie/core/utils/Encode moxie/file/Blob moxie/file/File moxie/runtime/html5/image/ImageInfo moxie/runtime/html5/image/ResizerCanvas moxie/core/utils/Mime moxie/core/utils/Env".split(" "),
function(g,c,d,b,a,f,e,m,k,h){return g.Image=function(){function h(){if(!v&&!n)throw new d.ImageError(d.DOMException.INVALID_STATE_ERR);return v||n}function g(){var a=h();if("canvas"==a.nodeName.toLowerCase())return a;v=document.createElement("canvas");v.width=a.width;v.height=a.height;v.getContext("2d").drawImage(a,0,0);return v}function r(a){return b.atob(a.substring(a.indexOf("base64,")+7))}function p(a){var c=this;n=new Image;n.onerror=function(){z.call(this);c.trigger("error",d.ImageError.WRONG_FORMAT)};
n.onload=function(){c.trigger("load")};n.src="data:"==a.substr(0,5)?a:"data:"+(A.type||"")+";base64,"+b.btoa(a)}function y(a,b){var c=this;if(window.FileReader){var e=new FileReader;e.onload=function(){b.call(c,this.result)};e.onerror=function(){c.trigger("error",d.ImageError.WRONG_FORMAT)};e.readAsDataURL(a)}else return b.call(this,a.getAsDataURL())}function z(){u&&(u.purge(),u=null);B=n=v=A=null;t=!1}var x=this,n,u,v,B,A,t=!1,w=!0;c.extend(this,{loadFromBlob:function(a){var b=this.getRuntime(),
c=1<arguments.length?arguments[1]:!0;if(!b.can("access_binary"))throw new d.RuntimeError(d.RuntimeError.NOT_SUPPORTED_ERR);A=a;a.isDetached()?(B=a.getSource(),p.call(this,B)):y.call(this,a.getSource(),function(a){c&&(B=r(a));p.call(this,a)})},loadFromImage:function(a,b){this.meta=a.meta;A=new f(null,{name:a.name,size:a.size,type:a.type});p.call(this,b?B=a.getAsBinaryString():a.getAsDataURL())},getInfo:function(){var b=this.getRuntime();!u&&B&&b.can("access_image_binary")&&(u=new e(B));b={width:h().width||
0,height:h().height||0,type:A.type||k.getFileMime(A.name),size:B&&B.length||A.size||0,name:A.name||"",meta:null};w&&(b.meta=u&&u.meta||this.meta||{},!b.meta||!b.meta.thumb||b.meta.thumb.data instanceof a||(b.meta.thumb.data=new a(null,{type:"image/jpeg",data:b.meta.thumb.data})));return b},resize:function(a,b,d){var e=document.createElement("canvas");e.width=a.width;e.height=a.height;e.getContext("2d").drawImage(h(),a.x,a.y,a.width,a.height,0,0,e.width,e.height);v=m.scale(e,b);w=d.preserveHeaders;
if(!w){a=v;b=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1;d=Math.PI/180;e=document.createElement("canvas");var f=e.getContext("2d"),l=a.width,g=a.height;-1<c.inArray(b,[5,6,7,8])?(e.width=g,e.height=l):(e.width=l,e.height=g);switch(b){case 2:f.translate(l,0);f.scale(-1,1);break;case 3:f.translate(l,g);f.rotate(180*d);break;case 4:f.translate(0,g);f.scale(1,-1);break;case 5:f.rotate(90*d);f.scale(1,-1);break;case 6:f.rotate(90*d);f.translate(0,-g);break;case 7:f.rotate(90*d);f.translate(l,
-g);f.scale(-1,1);break;case 8:f.rotate(-90*d),f.translate(-l,0)}f.drawImage(a,0,0,l,g);v=e}this.width=v.width;this.height=v.height;t=!0;this.trigger("Resize")},getAsCanvas:function(){v||(v=g());v.id=this.uid+"_canvas";return v},getAsBlob:function(a,b){return a!==this.type?(t=!0,new f(null,{name:A.name||"",type:a,data:x.getAsDataURL(a,b)})):new f(null,{name:A.name||"",type:a,data:x.getAsBinaryString(a,b)})},getAsDataURL:function(a,b){var c=b||90;if(!t)return n.src;g();if("image/jpeg"!==a)return v.toDataURL("image/png");
try{return v.toDataURL("image/jpeg",c/100)}catch(H){return v.toDataURL("image/jpeg")}},getAsBinaryString:function(a,b){if(!t)return B||(B=r(x.getAsDataURL(a,b))),B;if("image/jpeg"!==a)B=r(x.getAsDataURL(a,b));else{b||(b=90);g();try{var c=v.toDataURL("image/jpeg",b/100)}catch(H){c=v.toDataURL("image/jpeg")}B=r(c);u&&(B=u.stripHeaders(B),w&&(u.meta&&u.meta.exif&&u.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),B=u.writeHeaders(B)),u.purge(),u=null)}t=!1;return B},destroy:function(){x=
null;z.call(this);this.getRuntime().getShim().removeInstance(this.uid)}})}});n("moxie/runtime/flash/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(g,c,d,b,a){function f(){try{var a=navigator.plugins["Shockwave Flash"];a=a.description}catch(h){try{a=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(l){a="0.0"}}a=a.match(/\d+/g);return parseFloat(a[0]+"."+a[1])}function e(a){var b=
d.get(a);b&&"OBJECT"==b.nodeName&&("IE"===c.browser?(b.style.display="none",function q(){if(4==b.readyState){var c=d.get(a);if(c){for(var e in c)"function"==typeof c[e]&&(c[e]=null);c.parentNode.removeChild(c)}}else setTimeout(q,10)}()):b.parentNode.removeChild(b))}var m={};a.addConstructor("flash",function(k){var h=this,l;k=g.extend({swf_url:c.swf_url},k);a.call(this,k,"flash",{access_binary:function(a){return a&&"browser"===h.mode},access_image_binary:function(a){return a&&"browser"===h.mode},display_media:a.capTest(!!w["moxie/image/Image"]),
do_cors:a.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===h.mode},resize_image:a.capTrue,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!g.arrayDiff(a,["","text","document"])||"browser"===h.mode},return_status_code:function(a){return"browser"===h.mode||!g.arrayDiff(a,[200,404])},select_file:a.capTrue,select_multiple:a.capTrue,send_binary_string:function(a){return a&&"browser"===h.mode},send_browser_cookies:function(a){return a&&
"browser"===h.mode},send_custom_headers:function(a){return a&&"browser"===h.mode},send_multipart:a.capTrue,slice_blob:function(a){return a&&"browser"===h.mode},stream_upload:function(a){return a&&"browser"===h.mode},summon_file_dialog:!1,upload_filesize:function(a){return 2097152>=g.parseSizeStr(a)||"client"===h.mode},use_http_method:function(a){return!g.arrayDiff(a,["GET","POST"])}},{access_binary:function(a){return a?"browser":"client"},access_image_binary:function(a){return a?"browser":"client"},
report_upload_progress:function(a){return a?"browser":"client"},return_response_type:function(a){return g.arrayDiff(a,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(a){return g.arrayDiff(a,[200,404])?"browser":["client","browser"]},send_binary_string:function(a){return a?"browser":"client"},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?"browser":"client"},slice_blob:function(a){return a?"browser":
"client"},stream_upload:function(a){return a?"client":"browser"},upload_filesize:function(a){return 2097152<=g.parseSizeStr(a)?"client":"browser"}},"client");11.3>f()&&(MXI_DEBUG&&c.debug.runtime&&c.log("\tFlash didn't meet minimal version requirement (11.3)."),this.mode=!1);g.extend(this,{getShim:function(){return d.get(this.uid)},shimExec:function(a,b){var c=[].slice.call(arguments,2);return h.getShim().exec(this.uid,a,b,c)},init:function(){var d=this.getShimContainer();g.extend(d.style,{position:"absolute",
top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"});var e='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+k.swf_url+'" ';"IE"===c.browser&&(e+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ');e+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+k.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+a.getGlobalEventTarget()+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';
if("IE"===c.browser){var f=document.createElement("div");d.appendChild(f);f.outerHTML=e;f=d=null}else d.innerHTML=e;l=setTimeout(function(){h&&!h.initialized&&(h.trigger("Error",new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR)),MXI_DEBUG&&c.debug.runtime&&c.log("\tFlash failed to initialize within a specified period of time (typically 5s)."))},5E3)},destroy:function(a){return function(){e(h.uid);a.call(h);clearTimeout(l);k=l=a=h=null}}(this.destroy)},m)});return m});n("moxie/runtime/flash/file/Blob",
["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(g,c){return g.Blob={slice:function(d,b,a,f){var e=this.getRuntime();0>b?b=Math.max(d.size+b,0):0<b&&(b=Math.min(b,d.size));0>a?a=Math.max(d.size+a,0):0<a&&(a=Math.min(a,d.size));(d=e.shimExec.call(this,"Blob","slice",b,a,f||""))&&(d=new c(e.uid,d));return d}}});n("moxie/runtime/flash/file/FileInput",["moxie/runtime/flash/Runtime","moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(g,c,d,b){return g.FileInput={init:function(a){var f=
this,e=this.getRuntime(),g=d.get(a.browse_button);g&&(g.setAttribute("tabindex",-1),g=null);this.bind("Change",function(){var a=e.shimExec.call(f,"FileInput","getFiles");f.files=[];b.each(a,function(a){f.files.push(new c(e.uid,a))})},999);this.getRuntime().shimExec.call(this,"FileInput","init",{accept:a.accept,multiple:a.multiple});this.trigger("ready")}}});n("moxie/runtime/flash/file/FileReader",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(g,c){function d(b,a){switch(a){case "readAsText":return c.atob(b,
"utf8");case "readAsBinaryString":return c.atob(b);case "readAsDataURL":return b}return null}return g.FileReader={read:function(b,a){var c=this;c.result="";"readAsDataURL"===b&&(c.result="data:"+(a.type||"")+";base64,");c.bind("Progress",function(a,f){f&&(c.result+=d(f,b))},999);return c.getRuntime().shimExec.call(this,"FileReader","readAsBase64",a.uid)}}});n("moxie/runtime/flash/file/FileReaderSync",["moxie/runtime/flash/Runtime","moxie/core/utils/Encode"],function(g,c){function d(b,a){switch(a){case "readAsText":return c.atob(b,
"utf8");case "readAsBinaryString":return c.atob(b);case "readAsDataURL":return b}return null}return g.FileReaderSync={read:function(b,a){var c=this.getRuntime().shimExec.call(this,"FileReaderSync","readAsBase64",a.uid);if(!c)return null;"readAsDataURL"===b&&(c="data:"+(a.type||"")+";base64,"+c);return d(c,b,a.type)}}});n("moxie/runtime/flash/runtime/Transporter",["moxie/runtime/flash/Runtime","moxie/file/Blob"],function(g,c){return g.Transporter={getAsBlob:function(d){var b=this.getRuntime();return(d=
b.shimExec.call(this,"Transporter","getAsBlob",d))?new c(b.uid,d):null}}});n("moxie/runtime/flash/xhr/XMLHttpRequest","moxie/runtime/flash/Runtime moxie/core/utils/Basic moxie/file/Blob moxie/file/File moxie/file/FileReaderSync moxie/runtime/flash/file/FileReaderSync moxie/xhr/FormData moxie/runtime/Transporter moxie/runtime/flash/runtime/Transporter".split(" "),function(g,c,d,b,a,f,e,m,k){return g.XMLHttpRequest={send:function(a,b){function f(){a.transport=k.mode;k.shimExec.call(g,"XMLHttpRequest",
"send",a,b)}function h(a,c){k.shimExec.call(g,"XMLHttpRequest","appendBlob",a,c.uid);b=null;f()}function l(a,b){var c=new m;c.bind("TransportingComplete",function(){b(this.result)});c.transport(a.getSource(),a.type,{ruid:k.uid})}var g=this,k=g.getRuntime();c.isEmptyObj(a.headers)||c.each(a.headers,function(a,b){k.shimExec.call(g,"XMLHttpRequest","setRequestHeader",b,a.toString())});if(b instanceof e){var x;b.each(function(a,b){a instanceof d?x=b:k.shimExec.call(g,"XMLHttpRequest","append",b,a)});
if(b.hasBlob()){var n=b.getBlob();n.isDetached()?l(n,function(a){n.destroy();h(x,a)}):h(x,n)}else b=null,f()}else b instanceof d?b.isDetached()?l(b,function(a){b.destroy();b=a.uid;f()}):(b=b.uid,f()):f()},getResponse:function(d){var e,f=this.getRuntime();if(e=f.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){e=new b(f.uid,e);if("blob"===d)return e;try{var h=new a;if(~c.inArray(d,["","text"]))return h.readAsText(e);if("json"===d&&window.JSON)return JSON.parse(h.readAsText(e))}finally{e.destroy()}}return null},
abort:function(a){this.getRuntime().shimExec.call(this,"XMLHttpRequest","abort");this.dispatchEvent("readystatechange");this.dispatchEvent("abort")}}});n("moxie/runtime/flash/image/Image",["moxie/runtime/flash/Runtime","moxie/core/utils/Basic","moxie/runtime/Transporter","moxie/file/Blob","moxie/file/FileReaderSync"],function(g,c,d,b,a){return g.Image={loadFromBlob:function(a){function b(a){f.shimExec.call(c,"Image","loadFromBlob",a.uid);c=f=null}var c=this,f=c.getRuntime();if(a.isDetached()){var h=
new d;h.bind("TransportingComplete",function(){b(h.result.getSource())});h.transport(a.getSource(),a.type,{ruid:f.uid})}else b(a.getSource())},loadFromImage:function(a){return this.getRuntime().shimExec.call(this,"Image","loadFromImage",a.uid)},getInfo:function(){var a=this.getRuntime(),c=a.shimExec.call(this,"Image","getInfo");c.meta&&c.meta.thumb&&c.meta.thumb.data&&!(a.meta.thumb.data instanceof b)&&(c.meta.thumb.data=new b(a.uid,c.meta.thumb.data));return c},getAsBlob:function(a,c){var d=this.getRuntime(),
e=d.shimExec.call(this,"Image","getAsBlob",a,c);return e?new b(d.uid,e):null},getAsDataURL:function(){var b=this.getRuntime().Image.getAsBlob.apply(this,arguments);return b?(new a).readAsDataURL(b):null}}});n("moxie/runtime/silverlight/Runtime",["moxie/core/utils/Basic","moxie/core/utils/Env","moxie/core/utils/Dom","moxie/core/Exceptions","moxie/runtime/Runtime"],function(g,c,d,b,a){function f(a){var b=!1,c=null,d,e,f=0;try{try{c=new ActiveXObject("AgControl.AgControl"),c.IsVersionSupported(a)&&(b=
!0)}catch(M){var g=navigator.plugins["Silverlight Plug-In"];if(g){var m=g.description;"1.0.30226.2"===m&&(m="2.0.30226.2");for(d=m.split(".");3<d.length;)d.pop();for(;4>d.length;)d.push(0);for(e=a.split(".");4<e.length;)e.pop();do{var z=parseInt(e[f],10);var x=parseInt(d[f],10);f++}while(f<e.length&&z===x);z<=x&&!isNaN(z)&&(b=!0)}}}catch(M){b=!1}return b}var e={};a.addConstructor("silverlight",function(m){var k=this,h;m=g.extend({xap_url:c.xap_url},m);a.call(this,m,"silverlight",{access_binary:a.capTrue,
access_image_binary:a.capTrue,display_media:a.capTest(!!w["moxie/image/Image"]),do_cors:a.capTrue,drag_and_drop:!1,report_upload_progress:a.capTrue,resize_image:a.capTrue,return_response_headers:function(a){return a&&"client"===k.mode},return_response_type:function(a){return"json"!==a?!0:!!window.JSON},return_status_code:function(a){return"client"===k.mode||!g.arrayDiff(a,[200,404])},select_file:a.capTrue,select_multiple:a.capTrue,send_binary_string:a.capTrue,send_browser_cookies:function(a){return a&&
"browser"===k.mode},send_custom_headers:function(a){return a&&"client"===k.mode},send_multipart:a.capTrue,slice_blob:a.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:a.capTrue,use_http_method:function(a){return"client"===k.mode||!g.arrayDiff(a,["GET","POST"])}},{return_response_headers:function(a){return a?"client":"browser"},return_status_code:function(a){return g.arrayDiff(a,[200,404])?"client":["client","browser"]},send_browser_cookies:function(a){return a?"browser":"client"},send_custom_headers:function(a){return a?
"client":"browser"},use_http_method:function(a){return g.arrayDiff(a,["GET","POST"])?"client":["client","browser"]}});f("2.0.31005.0")&&"Opera"!==c.browser||(MXI_DEBUG&&c.debug.runtime&&c.log("\tSilverlight is not installed or minimal version (2.0.31005.0) requirement not met (not likely)."),this.mode=!1);g.extend(this,{getShim:function(){return d.get(this.uid).content.Moxie},shimExec:function(a,b){var c=[].slice.call(arguments,2);return k.getShim().exec(this.uid,a,b,c)},init:function(){this.getShimContainer().innerHTML=
'<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+m.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+a.getGlobalEventTarget()+'"/></object>';h=setTimeout(function(){k&&!k.initialized&&(k.trigger("Error",new b.RuntimeError(b.RuntimeError.NOT_INIT_ERR)),
MXI_DEBUG&&c.debug.runtime&&c.log("Silverlight failed to initialize within a specified period of time (5-10s)."))},"Windows"!==c.OS?1E4:5E3)},destroy:function(a){return function(){a.call(k);clearTimeout(h);m=h=a=k=null}}(this.destroy)},e)});return e});n("moxie/runtime/silverlight/file/Blob",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/Blob"],function(g,c,d){return g.Blob=c.extend({},d)});n("moxie/runtime/silverlight/file/FileInput",["moxie/runtime/silverlight/Runtime",
"moxie/file/File","moxie/core/utils/Dom","moxie/core/utils/Basic"],function(g,c,d,b){function a(a){for(var b="",c=0;c<a.length;c++)b+=(""!==b?"|":"")+a[c].title+" | *."+a[c].extensions.replace(/,/g,";*.");return b}return g.FileInput={init:function(f){var e=this,g=this.getRuntime(),k=d.get(f.browse_button);k&&(k.setAttribute("tabindex",-1),k=null);this.bind("Change",function(){var a=g.shimExec.call(e,"FileInput","getFiles");e.files=[];b.each(a,function(a){e.files.push(new c(g.uid,a))})},999);g.shimExec.call(this,
"FileInput","init",a(f.accept),f.multiple);this.trigger("ready")},setOption:function(b,c){"accept"==b&&(c=a(c));this.getRuntime().shimExec.call(this,"FileInput","setOption",b,c)}}});n("moxie/runtime/silverlight/file/FileDrop",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Dom","moxie/core/utils/Events"],function(g,c,d){return g.FileDrop={init:function(){var b=this.getRuntime();var a=b.getShimContainer();d.addEvent(a,"dragover",function(a){a.preventDefault();a.stopPropagation();a.dataTransfer.dropEffect=
"copy"},this.uid);d.addEvent(a,"dragenter",function(a){a.preventDefault();c.get(b.uid).dragEnter(a)&&a.stopPropagation()},this.uid);d.addEvent(a,"drop",function(a){a.preventDefault();c.get(b.uid).dragDrop(a)&&a.stopPropagation()},this.uid);return b.shimExec.call(this,"FileDrop","init")}}});n("moxie/runtime/silverlight/file/FileReader",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReader"],function(g,c,d){return g.FileReader=c.extend({},d)});n("moxie/runtime/silverlight/file/FileReaderSync",
["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/file/FileReaderSync"],function(g,c,d){return g.FileReaderSync=c.extend({},d)});n("moxie/runtime/silverlight/runtime/Transporter",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/runtime/Transporter"],function(g,c,d){return g.Transporter=c.extend({},d)});n("moxie/runtime/silverlight/xhr/XMLHttpRequest",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/runtime/flash/xhr/XMLHttpRequest",
"moxie/runtime/silverlight/file/FileReaderSync","moxie/runtime/silverlight/runtime/Transporter"],function(g,c,d,b,a){return g.XMLHttpRequest=c.extend({},d)});n("moxie/runtime/silverlight/image/Image",["moxie/runtime/silverlight/Runtime","moxie/core/utils/Basic","moxie/file/Blob","moxie/runtime/flash/image/Image"],function(g,c,d,b){return g.Image=c.extend({},b,{getInfo:function(){var a=this.getRuntime(),b=["tiff","exif","gps","thumb"],e={meta:{}},g=a.shimExec.call(this,"Image","getInfo");g.meta&&(c.each(b,
function(a){var b=g.meta[a],c,d;if(b&&b.keys){e.meta[a]={};var f=0;for(c=b.keys.length;f<c;f++){var m=b.keys[f];if(d=b[m])/^(\d|[1-9]\d+)$/.test(d)?d=parseInt(d,10):/^\d*\.\d+$/.test(d)&&(d=parseFloat(d)),e.meta[a][m]=d}}}),e.meta&&e.meta.thumb&&e.meta.thumb.data&&!(a.meta.thumb.data instanceof d)&&(e.meta.thumb.data=new d(a.uid,e.meta.thumb.data)));e.width=parseInt(g.width,10);e.height=parseInt(g.height,10);e.size=parseInt(g.size,10);e.type=g.type;e.name=g.name;return e},resize:function(a,b,c){this.getRuntime().shimExec.call(this,
"Image","resize",a.x,a.y,a.width,a.height,b,c.preserveHeaders,c.resample)}})});n("moxie/runtime/html4/Runtime",["moxie/core/utils/Basic","moxie/core/Exceptions","moxie/runtime/Runtime","moxie/core/utils/Env"],function(g,c,d,b){var a={};d.addConstructor("html4",function(c){var e=this,f=d.capTest,k=d.capTrue;d.call(this,c,"html4",{access_binary:f(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:f((b.can("create_canvas")||b.can("use_data_uri_over32kb"))&&!!w["moxie/image/Image"]),
do_cors:!1,drag_and_drop:!1,filter_by_extension:f(!("Chrome"===b.browser&&b.verComp(b.version,28,"<")||"IE"===b.browser&&b.verComp(b.version,10,"<")||"Safari"===b.browser&&b.verComp(b.version,11,"<=")||"Firefox"===b.browser&&b.verComp(b.version,37,"<")||"iOS"===b.os||"Android"===b.os)),resize_image:function(){return a.Image&&e.can("access_binary")&&b.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(a){return"json"===a&&window.JSON?!0:!!~g.inArray(a,
["text","document",""])},return_status_code:function(a){return!g.arrayDiff(a,[200,404])},select_file:function(){return b.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return e.can("select_file")},summon_file_dialog:function(){return e.can("select_file")&&!("Firefox"===b.browser&&b.verComp(b.version,4,"<")||"Opera"===b.browser&&b.verComp(b.version,12,"<")||"IE"===b.browser&&b.verComp(b.version,10,"<"))},
upload_filesize:k,use_http_method:function(a){return!g.arrayDiff(a,["GET","POST"])}});g.extend(this,{init:function(){this.trigger("Init")},destroy:function(a){return function(){a.call(e);a=e=null}}(this.destroy)});g.extend(this.getShim(),a)});return a});n("moxie/runtime/html4/file/FileInput","moxie/runtime/html4/Runtime moxie/file/File moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Events moxie/core/utils/Mime moxie/core/utils/Env".split(" "),function(g,c,d,b,a,f,e){return g.FileInput=
function(){function g(){var f=this,m=f.getRuntime(),q;var z=d.guid("uid_");var x=m.getShimContainer();k&&(q=b.get(k+"_form"))&&(d.extend(q.style,{top:"100%"}),q.firstChild.setAttribute("tabindex",-1));var n=document.createElement("form");n.setAttribute("id",z+"_form");n.setAttribute("method","post");n.setAttribute("enctype","multipart/form-data");n.setAttribute("encoding","multipart/form-data");d.extend(n.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"});var u=
document.createElement("input");u.setAttribute("id",z);u.setAttribute("type","file");u.setAttribute("accept",h.join(","));m.can("summon_file_dialog")&&u.setAttribute("tabindex",-1);d.extend(u.style,{fontSize:"999px",opacity:0});n.appendChild(u);x.appendChild(n);d.extend(u.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"});"IE"===e.browser&&e.verComp(e.version,10,"<")&&d.extend(u.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"});u.onchange=function(){if(this.value){var a=
this.files?this.files[0]:{name:this.value};a=new c(m.uid,a);this.onchange=function(){};g.call(f);f.files=[a];u.setAttribute("id",a.uid);n.setAttribute("id",a.uid+"_form");f.trigger("change");u=n=null}};m.can("summon_file_dialog")&&(x=b.get(l.browse_button),a.removeEvent(x,"click",f.uid),a.addEvent(x,"click",function(a){u&&!u.disabled&&u.click();a.preventDefault()},f.uid));k=z;x=q=x=null}var k,h=[],l,q;d.extend(this,{init:function(c){var d=this,e=d.getRuntime();l=c;h=f.extList2mimes(c.accept,e.can("filter_by_extension"));
var m=e.getShimContainer();(function(){var f;var h=b.get(c.browse_button);q=b.getStyle(h,"z-index")||"auto";e.can("summon_file_dialog")?("static"===b.getStyle(h,"position")&&(h.style.position="relative"),d.bind("Refresh",function(){f=parseInt(q,10)||1;b.get(l.browse_button).style.zIndex=f;this.getRuntime().getShimContainer().style.zIndex=f-1})):h.setAttribute("tabindex",-1);h=e.can("summon_file_dialog")?h:m;a.addEvent(h,"mouseover",function(){d.trigger("mouseenter")},d.uid);a.addEvent(h,"mouseout",
function(){d.trigger("mouseleave")},d.uid);a.addEvent(h,"mousedown",function(){d.trigger("mousedown")},d.uid);a.addEvent(b.get(c.container),"mouseup",function(){d.trigger("mouseup")},d.uid);h=null})();g.call(this);m=null;d.trigger({type:"ready",async:!0})},setOption:function(a,c){var d=this.getRuntime();"accept"==a&&(h=c.mimes||f.extList2mimes(c,d.can("filter_by_extension")));(d=b.get(k))&&d.setAttribute("accept",h.join(","))},disable:function(a){var c;if(c=b.get(k))c.disabled=!!a},destroy:function(){var c=
this.getRuntime(),d=c.getShim();c=c.getShimContainer();var e=l&&b.get(l.container),f=l&&b.get(l.browse_button);e&&a.removeAllEvents(e,this.uid);f&&(a.removeAllEvents(f,this.uid),f.style.zIndex=q);c&&(a.removeAllEvents(c,this.uid),c.innerHTML="");d.removeInstance(this.uid);k=h=l=null}})}});n("moxie/runtime/html4/file/FileReader",["moxie/runtime/html4/Runtime","moxie/runtime/html5/file/FileReader"],function(g,c){return g.FileReader=c});n("moxie/runtime/html4/xhr/XMLHttpRequest","moxie/runtime/html4/Runtime moxie/core/utils/Basic moxie/core/utils/Dom moxie/core/utils/Url moxie/core/Exceptions moxie/core/utils/Events moxie/file/Blob moxie/xhr/FormData".split(" "),
function(g,c,d,b,a,f,e,m){return g.XMLHttpRequest=function(){function g(a){var b=this,c,e=!1;if(q){var h=q.id.replace(/_iframe$/,"");if(h=d.get(h+"_form")){var g=h.getElementsByTagName("input");for(c=g.length;c--;)switch(g[c].getAttribute("type")){case "hidden":g[c].parentNode.removeChild(g[c]);break;case "file":e=!0}g=[];e||h.parentNode.removeChild(h);h=null}setTimeout(function(){f.removeEvent(q,"load",b.uid);q.parentNode&&q.parentNode.removeChild(q);var c=b.getRuntime().getShimContainer();c.children.length||
c.parentNode.removeChild(c);q=null;a()},1)}}var h,l,q;c.extend(this,{send:function(k,p){var n=this,z=n.getRuntime();h=l=null;if(p instanceof m&&p.hasBlob()){var x=p.getBlob();var r=x.uid;var u=d.get(r);var v=d.get(r+"_form");if(!v)throw new a.DOMException(a.DOMException.NOT_FOUND_ERR);}else r=c.guid("uid_"),v=document.createElement("form"),v.setAttribute("id",r+"_form"),v.setAttribute("method",k.method),v.setAttribute("enctype","multipart/form-data"),v.setAttribute("encoding","multipart/form-data"),
z.getShimContainer().appendChild(v);v.setAttribute("target",r+"_iframe");p instanceof m&&p.each(function(a,b){if(a instanceof e)u&&u.setAttribute("name",b);else{var d=document.createElement("input");c.extend(d,{type:"hidden",name:b,value:a});u?v.insertBefore(d,u):v.appendChild(d)}});v.setAttribute("action",k.url);(function(){var a=z.getShimContainer()||document.body,d=document.createElement("div");d.innerHTML='<iframe id="'+r+'_iframe" name="'+r+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>';
q=d.firstChild;a.appendChild(q);f.addEvent(q,"load",function(){try{var a=q.contentWindow.document||q.contentDocument||window.frames[q.id].document;/^4(0[0-9]|1[0-7]|2[2346])\s/.test(a.title)?h=a.title.replace(/^(\d+).*$/,"$1"):(h=200,l=c.trim(a.body.innerHTML),n.trigger({type:"progress",loaded:l.length,total:l.length}),x&&n.trigger({type:"uploadprogress",loaded:x.size||1025,total:x.size||1025}))}catch(S){if(b.hasSameOrigin(k.url))h=404;else{g.call(n,function(){n.trigger("error")});return}}g.call(n,
function(){n.trigger("load")})},n.uid)})();v.submit();n.trigger("loadstart")},getStatus:function(){return h},getResponse:function(a){if("json"===a&&"string"===c.typeOf(l)&&window.JSON)try{return JSON.parse(l.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(p){return null}return l},abort:function(){var a=this;q&&q.contentWindow&&(q.contentWindow.stop?q.contentWindow.stop():q.contentWindow.document.execCommand?q.contentWindow.document.execCommand("Stop"):q.src="about:blank");g.call(this,
function(){a.dispatchEvent("abort")})},destroy:function(){this.getRuntime().getShim().removeInstance(this.uid)}})}});n("moxie/runtime/html4/image/Image",["moxie/runtime/html4/Runtime","moxie/runtime/html5/image/Image"],function(g,c){return g.Image=c});(function(g){for(var c=0;c<g.length;c++){for(var d=t,b=g[c],a=b.split(/[.\/]/),f=0;f<a.length-1;++f)d[a[f]]===E&&(d[a[f]]={}),d=d[a[f]];d[a[a.length-1]]=w[b]}})("moxie/core/utils/Basic moxie/core/utils/Encode moxie/core/utils/Env moxie/core/Exceptions moxie/core/utils/Dom moxie/core/EventTarget moxie/runtime/Runtime moxie/runtime/RuntimeClient moxie/file/Blob moxie/core/I18n moxie/core/utils/Mime moxie/file/FileInput moxie/file/File moxie/file/FileDrop moxie/file/FileReader moxie/core/utils/Url moxie/runtime/RuntimeTarget moxie/xhr/FormData moxie/xhr/XMLHttpRequest moxie/image/Image moxie/core/utils/Events moxie/runtime/html5/image/ResizerCanvas".split(" "))})(this)});
(function(t,E){var D=function(){var n={};E.apply(n,arguments);return n.plupload};"function"===typeof define&&define.amd?define("plupload",["./moxie"],D):"object"===typeof module&&module.exports?module.exports=D(require("./moxie")):t.plupload=D(t.moxie)})(this||window,function(t){(function(E,D){function n(c,d){for(var b,a=[],f=0;f<c.length;++f){if(!(b=g[c[f]]))a:{b=E;for(var e=c[f].split(/[.\/]/),m=0;m<e.length;++m){if(!b[e[m]]){b=void 0;break a}b=b[e[m]]}}if(!b)throw"module definition dependecy not found: "+
c[f];a.push(b)}d.apply(null,a)}function w(c,d,b){if("string"!==typeof c)throw"invalid module definition, module id must be defined and be a string";if(d===D)throw"invalid module definition, dependencies must be specified";if(b===D)throw"invalid module definition, definition function must be specified";n(d,function(){g[c]=b.apply(null,arguments)})}var g={};w("plupload",[],function(){var c=t.core.utils;c.Env.global_event_dispatcher="plupload.EventTarget.instance.dispatchEvent";return{VERSION:"3.1.2",
STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,OPTION_ERROR:-800,moxie:t,ua:c.Env,typeOf:c.Basic.typeOf,clone:c.Basic.clone,inherit:c.Basic.inherit,extend:c.Basic.extend,extendImmutable:c.Basic.extendImmutable,extendIf:c.Basic.extendIf,inSeries:c.Basic.inSeries,inParallel:c.Basic.inParallel,
guid:c.Basic.guid,getAll:function(d){var b=[],a;"array"!==c.Basic.typeOf(d)&&(d=[d]);for(var f=d.length;f--;)(a=c.Dom.get(d[f]))&&b.push(a);return b.length?b:null},get:c.Dom.get,each:c.Basic.each,getPos:c.Dom.getPos,getSize:c.Dom.getSize,xmlEncode:function(c){var b={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},a=/[<>&"']/g;return c?(""+c).replace(a,function(a){return b[a]?"&"+b[a]+";":a}):c},toArray:c.Basic.toArray,inArray:c.Basic.inArray,addI18n:t.core.I18n.addI18n,translate:t.core.I18n.translate,
sprintf:c.Basic.sprintf,isEmptyObj:c.Basic.isEmptyObj,hasClass:c.Dom.hasClass,addClass:c.Dom.addClass,removeClass:c.Dom.removeClass,getStyle:c.Dom.getStyle,addEvent:c.Events.addEvent,removeEvent:c.Events.removeEvent,removeAllEvents:c.Events.removeAllEvents,cleanName:function(c){var b;var a=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,
"U",/[\371-\374]/g,"u"];for(b=0;b<a.length;b+=2)c=c.replace(a[b],a[b+1]);c=c.replace(/\s+/g,"_");return c=c.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(d,b){var a="";c.Basic.each(b,function(b,c){a+=(a?"&":"")+encodeURIComponent(c)+"="+encodeURIComponent(b)});a&&(d+=(0<d.indexOf("?")?"&":"?")+a);return d},formatSize:function(c){function b(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)}c=parseInt(c,10);if(isNaN(c))return this.translate("N/A");var a=Math.pow(1024,4);return c>a?b(c/a,
1)+" "+this.translate("tb"):c>(a/=1024)?b(c/a,1)+" "+this.translate("gb"):c>(a/=1024)?b(c/a,1)+" "+this.translate("mb"):1024<c?Math.round(c/1024)+" "+this.translate("kb"):c+" "+this.translate("b")},mimes2extList:t.core.utils.Mime.mimes2extList,resolveUrl:c.Url.resolveUrl,parseSize:c.Basic.parseSizeStr,delay:c.Basic.delay,EventTarget:t.core.EventTarget,Runtime:t.runtime.Runtime,FileInput:t.file.FileInput,FileReader:t.file.FileReader}});w("plupload/core/Collection",["plupload"],function(c){var d=function(){var b=
{},a=0,c;plupload.extend(this,{count:function(){return a},hasKey:function(a){return b.hasOwnProperty(a)},get:function(a){return b[a]},first:function(){for(var a in b)return b[a]},last:function(){return c},toObject:function(){return b},add:function(d,f){var e=this;if("object"===typeof d&&!f)return plupload.each(d,function(a,b){e.add(b,a)});if(b.hasOwnProperty(d))return e.update.apply(e,arguments);b[d]=c=f;a++},remove:function(d){if(this.hasKey(d)){var e=b[d];delete b[d];a--;if(c===e){for(var f in b);
c=b[f]}}},extract:function(a){var b=this.get(a);this.remove(a);return b},shift:function(){var a;for(a in b){var c=b[a];this.remove(a);return c}},update:function(a,c){b[a]=c},each:function(a){plupload.each(b,a)},combineWith:function(){var a=new d;a.add(b);plupload.each(arguments,function(b){b instanceof d&&a.add(b.toObject())});return a},clear:function(){b={};c=null;a=0}})};return d});w("plupload/core/ArrCollection",["plupload"],function(c){return function(){var d=[];c.extend(this,{count:function(){return d.length},
hasKey:function(b){return-1<this.getIdx(b)},get:function(b){b=this.getIdx(b);return-1<b?d[b]:null},getIdx:function(b){for(var a=0,c=d.length;a<c;a++)if(d[a].uid===b)return a;return-1},getByIdx:function(b){return d[b]},first:function(){return d[0]},last:function(){return d[d.length-1]},add:function(b,a){b=a||b;var c=this.getIdx(b.uid);if(-1<c)return d[c]=b,c;d.push(b);return d.length-1},remove:function(b){return!!this.extract(b)},splice:function(b,a){b="undefinded"===c.typeOf(b)?0:Math.max(b,0);a=
"undefinded"!==c.typeOf(a)&&b+a<d.length?a:d.length-b;return d.splice(b,a)},extract:function(b){b=this.getIdx(b);return-1<b?d.splice(b,1):null},shift:function(){return d.shift()},update:function(b,a){var c=this.getIdx(b);return-1<c?(d[c]=a,!0):!1},each:function(b){c.each(d,b)},combineWith:function(){return Array.prototype.concat.apply(this.toArray(),arguments)},sort:function(b){d.sort(b||function(a,b){return a.priority-b.priority})},clear:function(){d=[]},toObject:function(){for(var b={},a=0,c=d.length;a<
c;a++)b[d[a].uid]=d[a];return b},toArray:function(){return Array.prototype.slice.call(d)}})}});w("plupload/core/Optionable",["plupload"],function(c){return function(d){function b(){d.apply(this,arguments);this._options={}}c.inherit(b,d);c.extend(b.prototype,{setOption:function(a,b,d){var e=this;if("object"===typeof a)d=b,c.each(a,function(a,b){e.setOption(b,a,d)});else if(!d||e._options.hasOwnProperty(a)){var f=c.clone(e._options[a]);"object"===c.typeOf(b)&&"object"===c.typeOf(e._options[a])?c.extend(e._options[a],
b):e._options[a]=b;e.trigger("OptionChanged",a,b,f)}},getOption:function(a){if(!a)return this._options;a=this._options[a];return-1<c.inArray(c.typeOf(a),["array","object"])?c.extendImmutable({},a):a},setOptions:function(a,b){"object"===typeof a&&this.setOption(a,b)},getOptions:function(){return this.getOption()}});return b}(t.core.EventTarget)});w("plupload/core/Queueable",["plupload","plupload/core/Optionable"],function(c,d){return function(b){function a(){b.apply(this,arguments);this.uid=c.guid();
this.state=a.IDLE;this.processedTimestamp=this.startedTimestamp=this.priority=this.retries=this.percent=this.total=this.processed=0;MXI_DEBUG&&this.bind("StateChanged",function(b,d,g){var e=this;b=function(b){switch(b){case a.IDLE:return"IDLE";case a.PROCESSING:return"PROCESSING";case a.PAUSED:return"PAUSED";case a.RESUMED:return"RESUMED";case a.DONE:return"DONE";case a.FAILED:return"FAILED";case a.DESTROYED:return"DESTROYED"}};c.ua.log("StateChanged:"+function(){switch(e.ctorName){case "File":return"\t".repeat(2);
case "QueueUpload":case "QueueResize":return"\t";case "FileUploader":return"\t".repeat(3);case "ChunkUploader":return"\t".repeat(4);default:return"\t"}}()+e.ctorName+"::"+e.uid+" ("+b(g)+" to "+b(d)+")")},999)}a.IDLE=1;a.PROCESSING=2;a.PAUSED=6;a.RESUMED=7;a.DONE=5;a.FAILED=4;a.DESTROYED=8;c.inherit(a,b);c.extend(a.prototype,{start:function(){var b=this.state;if(this.state===a.PROCESSING)return!1;this.startedTimestamp||(this.startedTimestamp=+new Date);this.state=a.PROCESSING;this.trigger("statechanged",
this.state,b);this.trigger("started");return!0},pause:function(){var b=this.state;if(-1===c.inArray(this.state,[a.IDLE,a.RESUMED,a.PROCESSING]))return!1;this.loaded=this.processed=this.percent=0;this.state=a.PAUSED;this.trigger("statechanged",this.state,b);this.trigger("paused");return!0},resume:function(){var b=this.state;if(this.state!==a.PAUSED&&this.state!==a.RESUMED)return!1;this.state=a.RESUMED;this.trigger("statechanged",this.state,b);this.trigger("resumed");return!0},stop:function(){var b=
this.state;if(this.state===a.IDLE)return!1;this.startedTimestamp=this.loaded=this.processed=this.percent=0;this.state=a.IDLE;this.trigger("statechanged",this.state,b);this.trigger("stopped");return!0},done:function(b){var c=this.state;if(this.state===a.DONE)return!1;this.loaded=this.processed=this.total;this.percent=100;this.processedTimestamp=+new Date;this.state=a.DONE;this.trigger("statechanged",this.state,c);this.trigger("done",b);this.trigger("processed");return!0},failed:function(b){var c=this.state;
if(this.state===a.FAILED)return!1;this.loaded=this.processed=this.percent=0;this.processedTimestamp=+new Date;this.state=a.FAILED;this.trigger("statechanged",this.state,c);this.trigger("failed",b);this.trigger("processed");return!0},progress:function(a,b){b&&(this.total=b);this.loaded=this.processed=Math.min(a,this.total);this.percent=Math.ceil(this.processed/this.total*100);this.trigger({type:"progress",loaded:this.processed,total:this.total})},destroy:function(){var b=this.state;if(this.state===
a.DESTROYED)return!1;this.state=a.DESTROYED;this.trigger("statechanged",this.state,b);this.trigger("destroy");this.unbindAll();return!0}});return a}(d)});w("plupload/core/Stats",[],function(){return function(){var c=this;c.size=0;c.total=0;c.loaded=0;c.uploaded=0;c.done=0;c.failed=0;c.queued=0;c.paused=0;c.processing=0;c.paused=0;c.percent=0;c.bytesPerSec=0;c.processedPerSec=0;c.reset=function(){c.size=c.total=c.loaded=c.processed=c.uploaded=c.done=c.failed=c.queued=c.processing=c.paused=c.percent=
c.bytesPerSec=c.processedPerSec=0}}});w("plupload/core/Queue",["plupload","plupload/core/ArrCollection","plupload/core/Queueable","plupload/core/Stats"],function(c,d,b,a){return function(f){function e(b){f.apply(this,arguments);this._queue=new d;this.stats=new a;this._options=c.extend({},this._options,{max_slots:1,max_retries:0,auto_start:!1,finish_active:!1},b)}function g(){var a;this.forEachItem(function(c){if(c.state===b.IDLE||c.state===b.RESUMED)return a=c,!1});return a?a:null}function k(){var a;
if(this.state!==b.PROCESSING&&this.state!==b.PAUSED)return!1;if(this.stats.processing<this.getOption("max_slots")&&(a=g.call(this))){if(a.trigger("beforestart"))return a.setOptions(this.getOptions()),a.start();a.pause();k.call(this)}return!1}c.inherit(e,f);c.extend(e.prototype,{count:function(){return this._queue.count()},start:function(){return e.parent.start.call(this)?k.call(this):!1},pause:function(){if(!e.parent.pause.call(this))return!1;this.forEachItem(function(a){a.pause()})},stop:function(){if(!e.parent.stop.call(this)||
this.getOption("finish_active"))return!1;this.isActive()&&this.forEachItem(function(a){a.stop()})},forEachItem:function(a){this._queue.each(a)},getItem:function(a){return this._queue.get(a)},addItem:function(a){var d=this;a.bind("Started",function(){d.calcStats()&&c.delay.call(d,k)});a.bind("Resumed",function(){d.start()});a.bind("Paused",function(){d.calcStats()&&c.delay.call(d,function(){k.call(d)||d.stats.processing||d.pause()})});a.bind("Processed Stopped",function(){d.calcStats()&&c.delay.call(d,
function(){k.call(d)||this.isStopped()||this.isActive()||d.stop()})});a.bind("Progress",function(){d.calcStats()&&d.trigger("Progress",d.stats.processed,d.stats.total,d.stats)});a.bind("Failed",function(){d.getOption("max_retries")&&this.retries<d.getOption("max_retries")&&(this.stop(),this.retries++)});this._queue.add(a.uid,a);this.calcStats();a.trigger("Queued");(d.getOption("auto_start")||d.state===b.PAUSED)&&c.delay.call(this,this.start)},extractItem:function(a){var b=this._queue.get(a);b&&(this.stopItem(b.uid),
this._queue.remove(a),this.calcStats());return b},removeItem:function(a){return(a=this.extractItem(a))?(a.destroy(),!0):!1},stopItem:function(a){return(a=this._queue.get(a))?a.stop():!1},pauseItem:function(a){return(a=this._queue.get(a))?a.pause():!1},resumeItem:function(a){return(a=this._queue.get(a))?(c.delay.call(this,function(){this.start()}),a.resume()):!1},splice:function(a,b){return this._queue.splice(a,b)},isActive:function(){return this.stats&&(this.stats.processing||this.stats.paused)},
isStopped:function(){return this.state===b.IDLE||this.state===b.DESTROYED},countSpareSlots:function(){return Math.max(this.getOption("max_slots")-this.stats.processing,0)},toArray:function(){return this._queue.toArray()},clear:function(){var a=this;if(a.state!==b.IDLE)return a.bindOnce("Stopped",function(){a.clear()}),a.stop();a._queue.clear();a.stats.reset()},calcStats:function(){var a=this,c=a.stats,d=0,e=0;if(!c)return!1;c.reset();a.forEachItem(function(f){switch(f.state){case b.DONE:c.done++;
c.uploaded=c.done;break;case b.FAILED:c.failed++;break;case b.PROCESSING:c.processing++;break;case b.PAUSED:c.paused++;break;default:c.queued++}d+=f.processed;if(!f.processedTimestamp||f.processedTimestamp>a.startedTimestamp)e+=d;c.processedPerSec=Math.ceil(e/((+new Date-a.startedTimestamp||1)/1E3));c.processed=d;c.total+=f.total;c.total&&(c.percent=Math.ceil(c.processed/c.total*100))});a.percent=c.percent;c.loaded=c.processed;c.size=c.total;c.bytesPerSec=c.processedPerSec;return!0},destroy:function(){var a=
this;if(a.state===b.DESTROYED)return!1;if(a.state!==b.IDLE)return a.bindOnce("Stopped",function(){c.delay.call(a,a.destroy)}),a.stop();a.clear();e.parent.destroy.call(this);a._queue=a.stats=null;return!0}});return e}(b)});w("plupload/QueueUpload",["plupload","plupload/core/Queue"],function(c,d){return function(b){function a(b){d.call(this,{max_slots:1,max_retries:0,auto_start:!1,finish_active:!1,url:!1,chunk_size:0,multipart:!0,http_method:"POST",params:{},headers:!1,file_data_name:"file",send_file_name:!0,
stop_on_fail:!0});this.setOption=function(b,c){"object"!==typeof b&&"max_upload_slots"==b&&(b="max_slots");a.prototype.setOption.call(this,b,c,!0)};this.setOptions(b)}c.inherit(a,b);return a}(d)});w("plupload/QueueResize",["plupload","plupload/core/Queue"],function(c,d){return function(b){function a(b){d.call(this,{max_slots:1,max_retries:0,auto_start:!1,finish_active:!1,resize:{}});this.setOption=function(b,c){"object"!==typeof b&&"max_resize_slots"==b&&(b="max_slots");a.prototype.setOption.call(this,
b,c,!0)};this.setOptions(b)}c.inherit(a,b);return a}(d)});w("plupload/ChunkUploader",["plupload","plupload/core/Collection","plupload/core/Queueable"],function(c,d,b){function a(d){function g(a,b){var d="";c.each(b,function(a,b){d+=(d?"&":"")+encodeURIComponent(b)+"="+encodeURIComponent(a)});d&&(a+=(0<a.indexOf("?")?"&":"?")+d);return a}var h;b.call(this);this._options={file_data_name:"file",headers:!1,http_method:"POST",multipart:!0,params:{},send_file_name:!0,url:!1};c.extend(this,{start:function(){var a=
this,m=this.state,k=a._options;if(this.state===b.PROCESSING)return!1;this.startedTimestamp||(this.startedTimestamp=+new Date);this.state=b.PROCESSING;this.trigger("statechanged",this.state,m);h=new f;h.upload&&(h.upload.onprogress=function(b){a.progress(b.loaded,b.total)});h.onload=function(){var b={response:this.responseText,status:this.status,responseHeaders:this.getAllResponseHeaders()};if(200>this.status||400<=this.status)return a.failed(b);a.done(b)};h.onerror=function(){a.failed()};h.onloadend=
function(){setTimeout(function(){h&&(h.destroy(),h=null)},1)};try{var p=k.multipart?k.url:g(k.url,k.params);h.open(k.http_method,p,!0);c.isEmptyObj(k.headers)||c.each(k.headers,function(a,b){h.setRequestHeader(b,a)});if(k.multipart){var n=new e;c.isEmptyObj(k.params)||c.each(k.params,function(a,b){n.append(b,a)});n.append(k.file_data_name,d);h.send(n)}else!c.isEmptyObj(k.headers)&&h.hasRequestHeader("content-type")||h.setRequestHeader("content-type","application/octet-stream"),h.send(d);this.trigger("started")}catch(z){a.failed()}},
stop:function(){h&&(h.abort(),h.destroy(),h=null);a.prototype.stop.call(this)},setOption:function(b,c){a.prototype.setOption.call(this,b,c,!0)},setOptions:function(b){a.prototype.setOption.call(this,b,!0)},destroy:function(){this.stop();a.prototype.destroy.call(this)}})}var f=t.xhr.XMLHttpRequest,e=t.xhr.FormData;c.inherit(a,b);return a});w("plupload/FileUploader",["plupload","plupload/core/Collection","plupload/core/Queueable","plupload/ChunkUploader"],function(c,d,b,a){function f(e,g){function k(){var a=
0;l.each(function(c){c.state===b.DONE&&(a+=c.end-c.start)});return a}function h(){for(var a=0;a<m&&l.hasKey(a);)a++;return a}var l=new d,m=1;b.call(this);this._options={chunk_size:0,params:{},send_file_name:!0,stop_on_fail:!0};c.extend(this,{name:e.name,start:function(){var c=this,d=this.state;if(this.state===b.PROCESSING)return!1;this.startedTimestamp||(this.startedTimestamp=+new Date);this.state=b.PROCESSING;this.trigger("statechanged",this.state,d);c._options.send_file_name&&(c._options.params.name=
c.target_name||c.name);c._options.chunk_size?(m=Math.ceil(e.size/c._options.chunk_size),c.uploadChunk(!1,!0)):(d=new a(e),d.bind("progress",function(a){c.progress(a.loaded,a.total)}),d.bind("done",function(a,b){c.done(b)}),d.bind("failed",function(a,b){c.failed(b)}),d.setOptions(c._options),g.addItem(d));this.trigger("started")},uploadChunk:function(d,f){var n=this,q=this.getOption("chunk_size"),p={};p.seq=parseInt(d,10)||h();p.start=p.seq*q;p.end=Math.min(p.start+q,e.size);p.total=e.size;if(0>p.start||
p.start>=e.size)return!1;var r=c.extendImmutable({},this.getOptions(),{params:{chunk:p.seq,chunks:m}});q=new a(e.slice(p.start,p.end,e.type));q.bind("progress",function(a){n.progress(k()+a.loaded,e.size)});q.bind("failed",function(a,d){l.add(p.seq,c.extend({state:b.FAILED},p));n.trigger("chunkuploadfailed",c.extendImmutable({},p,d));r.stop_on_fail&&n.failed(d)});q.bind("done",function(a,d){l.add(p.seq,c.extend({state:b.DONE},p));n.trigger("chunkuploaded",c.extendImmutable({},p,d));k()>=e.size?(n.progress(e.size,
e.size),n.done(d)):f&&c.delay(function(){n.uploadChunk(h(),f)})});q.bind("processed",function(){this.destroy()});q.setOptions(r);l.add(p.seq,c.extend({state:b.PROCESSING},p));g.addItem(q);f&&g.countSpareSlots()&&n.uploadChunk(h(),f);return!0},destroy:function(){f.prototype.destroy.call(this);l.clear()}})}c.inherit(f,b);return f});w("plupload/ImageResizer",["plupload","plupload/core/Queueable"],function(c,d){function b(c){d.call(this);this._options={type:"image/jpeg",quality:90,crop:!1,fit:!0,preserveHeaders:!0,
resample:"default",multipass:!0};this.setOption=function(a,c){("object"===typeof a||this._options.hasOwnProperty(a))&&b.prototype.setOption.apply(this,arguments)};this.start=function(b){var d=this;b&&this.setOptions(b.resize);b=new a;b.bind("load",function(){this.resize(d.getOptions())});b.bind("resize",function(){d.done(this.getAsBlob(d.getOption("type"),d.getOption("quality")));this.destroy()});b.bind("error",function(){d.failed();this.destroy()});b.load(c,d.getOption("runtimeOptions"))}}var a=
t.image.Image;c.inherit(b,d);c.Image=a;return b});w("plupload/File",["plupload","plupload/core/Queueable","plupload/FileUploader","plupload/ImageResizer"],function(c,d,b,a){function f(e,g,k){d.call(this);c.extend(this,{id:this.uid,name:e.name,target_name:null,type:e.type,size:e.size,origSize:e.size,start:function(){var a=this.state;if(this.state===d.PROCESSING)return!1;this.state=d.PROCESSING;this.trigger("statechanged",this.state,a);this.trigger("started");if(a=!c.isEmptyObj(this._options.resize)&&
-1<c.inArray(this.type,["image/jpeg","image/png"]))a:{if(e.ruid&&(a=c.Runtime.getInfo(e.ruid))){a=a.can("send_binary_string");break a}a=!1}a?this.resizeAndUpload():this.upload();return!0},getSource:function(){return e},getNative:function(){return this.getFile().getSource()},resizeAndUpload:function(){var b=this,c=b.getOptions(),d=new a(e);d.bind("progress",function(a){b.progress(a.loaded,a.total)});d.bind("done",function(a,c){b.upload()});d.bind("failed",function(){b.upload()});d.setOption("runtimeOptions",
{runtime_order:c.runtimes,required_caps:c.required_features,preferred_caps:c.preferred_caps,swf_url:c.flash_swf_url,xap_url:c.silverlight_xap_url});k.addItem(d)},upload:function(){var a=this,c=new b(e,g);c.bind("paused",function(){a.pause()});c.bind("resumed",function(){this.start()});c.bind("started",function(){a.trigger("startupload")});c.bind("progress",function(b){a.progress(b.loaded,b.total)});c.bind("done",function(b,c){a.done(c)});c.bind("failed",function(b,c){a.failed(c)});c.setOptions(a.getOptions());
c.start()},destroy:function(){f.prototype.destroy.call(this);e=null}})}c.inherit(f,d);return f});w("plupload/Uploader","plupload plupload/core/Collection plupload/core/Queue plupload/QueueUpload plupload/QueueResize plupload/File".split(" "),function(c,d,b,a,f,e){function g(d){function k(){var a=A[0]||D[0];return a?a.getRuntime().uid:!1}function m(){this.bind("FilesAdded FilesRemoved",function(a){a.trigger("QueueChanged");a.refresh()},this,999);this.bind("BeforeUpload",q);this.bind("Stopped",function(a){a.trigger("UploadComplete")});
this.bind("Error",y);this.bind("Destroy",w)}function n(a){var b=this,d=0,e=[],f={runtime_order:b.getOption("runtimes"),required_caps:b.getOption("required_features"),preferred_caps:b.getOption("preferred_caps"),swf_url:b.getOption("flash_swf_url"),xap_url:b.getOption("silverlight_xap_url")};c.each(b.getOption("runtimes").split(/\s*,\s*/),function(a){b.getOption(a)&&(f[a]=b.getOption(a))});b.getOption("browse_button")&&c.each(b.getOption("browse_button"),function(a){e.push(function(e){var g=new t.file.FileInput(c.extend({},
f,{accept:b.getOption("filters").mime_types,name:b.getOption("file_data_name"),multiple:b.getOption("multi_selection"),container:b.getOption("container"),browse_button:a}));g.onready=function(){var a=c.Runtime.getInfo(this.ruid);c.extend(b.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),multi_selection:a.can("select_multiple")});d++;A.push(this);e()};g.onchange=function(){b.addFile(this.files)};g.bind("mouseenter mouseleave mousedown mouseup",function(d){I||(b.getOption("browse_button_hover")&&
("mouseenter"===d.type?c.addClass(a,b.getOption("browse_button_hover")):"mouseleave"===d.type&&c.removeClass(a,b.getOption("browse_button_hover"))),b.getOption("browse_button_active")&&("mousedown"===d.type?c.addClass(a,b.getOption("browse_button_active")):"mouseup"===d.type&&c.removeClass(a,b.getOption("browse_button_active"))))});g.bind("mousedown",function(){b.trigger("Browse")});g.bind("error runtimeerror",function(){g=null;e()});g.init()})});b.getOption("drop_element")&&c.each(b.getOption("drop_element"),
function(a){e.push(function(e){var g=new t.file.FileDrop(c.extend({},f,{drop_zone:a}));g.onready=function(){var a=c.Runtime.getInfo(this.ruid);c.extend(b.features,{chunks:a.can("slice_blob"),multipart:a.can("send_multipart"),dragdrop:a.can("drag_and_drop")});d++;D.push(this);e()};g.ondrop=function(){b.addFile(this.files)};g.bind("error runtimeerror",function(){g=null;e()});g.init()})});c.inParallel(e,function(){"function"===typeof a&&a(d)})}function q(a,b){if(a.getOption("unique_names")){var c=b.name.match(/\.([^.]+)$/),
d="part";c&&(d=c[1]);b.target_name=b.id+"."+d}}function y(a,b){b.code===c.INIT_ERROR?a.destroy():b.code===c.HTTP_ERROR&&a.state==c.STARTED&&a.trigger("CancelUpload")}function w(a){a.forEachItem(function(a){a.destroy()});A.length&&(c.each(A,function(a){a.destroy()}),A=[]);D.length&&(c.each(D,function(a){a.destroy()}),D=[]);J=!1;E&&E.destroy();G&&G.destroy();H=E=G=null}var A=[],D=[],E,G,J=!1,I=!1,H=h(c.extend({backward_compatibility:!0,chunk_size:0,file_data_name:"file",filters:{mime_types:"*",prevent_duplicates:!1,
max_file_size:0},flash_swf_url:"js/Moxie.swf",http_method:"POST",max_resize_slots:1,max_retries:0,max_upload_slots:1,multipart:!0,multipart_params:{},multi_selection:!0,params:{},resize:!1,runtimes:c.Runtime.order,send_chunk_number:!0,send_file_name:!0,silverlight_xap_url:"js/Moxie.xap",required_features:!1,preferred_caps:!1},d));b.call(this);c.extend(this,{_options:H,id:this.uid,state:c.STOPPED,features:{},settings:H,runtime:null,files:[],total:this.stats,init:function(){var b=this,d;var e=b.getOption("preinit");
"function"==typeof e?e(b):c.each(e,function(a,c){b.bind(c,a)});m.call(b);c.each(["container","browse_button","drop_element"],function(a){if(null===b.getOption(a))return d={code:c.INIT_ERROR,message:c.sprintf(c.translate("%s specified, but cannot be found."),a)},!1});if(d)return b.trigger("Error",d);if(!b.getOption("browse_button")&&!b.getOption("drop_element"))return b.trigger("Error",{code:c.INIT_ERROR,message:c.translate("You must specify either browse_button or drop_element.")});n.call(b,function(d){var e=
b.getOption("init"),g=c.extendImmutable({},b.getOption(),{auto_start:!0});"function"==typeof e?e(b):c.each(e,function(a,c){b.bind(c,a)});d?(J=!0,d=c.Runtime.getInfo(k()),E=new a(g),G=new f(g),b.trigger("Init",{ruid:d.uid,runtime:b.runtime=d.type}),b.trigger("PostInit")):b.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})})},setOption:function(a,b){if(J&&-1<c.inArray(a,"container browse_button drop_element runtimes multi_selection flash_swf_url silverlight_xap_url".split(" ")))return this.trigger("Error",
{code:c.OPTION_ERROR,message:c.sprintf(c.translate("%s option cannot be changed.")),option:a});"object"!==typeof a&&(b=l(a,b,this._options),E&&E.setOption(a,b),G&&G.setOption(a,b));g.prototype.setOption.call(this,a,b)},refresh:function(){A.length&&c.each(A,function(a){a.trigger("Refresh")});D.length&&c.each(D,function(a){a.trigger("Refresh")});this.trigger("Refresh")},stop:function(){g.prototype.stop.call(this)&&this.state!=c.STOPPED&&this.trigger("CancelUpload")},disableBrowse:function(a){I=a!==
p?a:!0;A.length&&c.each(A,function(a){a.disable(I)});this.trigger("DisableBrowse",I)},getFile:function(a){return this.getItem(a)},addFile:function(a,b){function d(a){a.bind("beforestart",function(a){return h.trigger("BeforeUpload",a.target)});a.bind("startupload",function(){h.trigger("UploadFile",this)});a.bind("progress",function(){h.trigger("UploadProgress",this)});a.bind("done",function(a,b){h.trigger("FileUploaded",this,b)});a.bind("failed",function(a,b){h.trigger("Error",c.extend({code:c.HTTP_ERROR,
message:c.translate("HTTP Error."),file:this},b))})}function f(a,b){var d=[];c.each(h.getOption("filters"),function(b,c){r[c]&&d.push(function(d){r[c].call(h,b,a,function(a){d(!a)})})});c.inParallel(d,b)}function g(a){var k=c.typeOf(a);if(a instanceof t.file.File){if(!a.ruid&&!a.isDetached()){if(!n)return!1;a.ruid=n;a.connectRuntime(n)}l.push(function(g){f(a,function(f){f||(f=new e(a,E,G),b&&(f.name=b),d(f),h.addItem(f),m.push(f),h.trigger("FileFiltered",f));c.delay(g)})})}else a instanceof t.file.Blob?
(g(a.getSource()),a.destroy()):-1!==c.inArray(k,["file","blob"])?g(new t.file.File(null,a)):"node"===k&&"filelist"===c.typeOf(a.files)?c.each(a.files,g):"array"===k&&(b=null,c.each(a,g))}var h=this,l=[],m=[];var n=k();g(a);l.length&&c.inParallel(l,function(){m.length&&h.trigger("FilesAdded",m)})},removeFile:function(a){if(a=this.extractItem("string"===typeof a?a:a.uid))this.trigger("FilesRemoved",[a]),a.destroy()},splice:function(){var a,d=c.STARTED==this.state,e=b.prototype.splice.apply(this,arguments);
if(e.length){this.trigger("FilesRemoved",e);d&&this.stop();for(a=0;a<e.length;a++)e[a].destroy();d&&this.start()}},dispatchEvent:function(a){var b;a=a.toLowerCase();if(b=this.hasEventListener(a)){b.sort(function(a,b){return b.priority-a.priority});var c=[].slice.call(arguments);c.shift();c.unshift(this);for(var d=0;d<b.length;d++)if(!1===b[d].fn.apply(b[d].scope,c))return!1}return!0},bind:function(a,b,d,e){c.Uploader.prototype.bind.call(this,a,b,e,d)}});H.backward_compatibility&&(this.bind("FilesAdded FilesRemoved",
function(a){a.files=a.toArray()},this,999),this.bind("OptionChanged",function(a,b,d){a.settings[b]="object"==typeof d?c.extend({},d):d},this,999))}function k(a){function b(a,b,c){var d={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};
d[a]?e[d[a]]=b:c||(e[a]=b)}var d=a.required_features,e={};"string"===typeof d?c.each(d.split(/\s*,\s*/),function(a){b(a,!0)}):"object"===typeof d?c.each(d,function(a,c){b(c,a)}):!0===d&&(a.chunk_size&&0<a.chunk_size&&(e.slice_blob=!0),c.isEmptyObj(a.resize)&&!1!==a.multipart||(e.send_binary_string=!0),a.http_method&&(e.use_http_method=a.http_method),c.each(a,function(a,c){b(c,!!a,!0)}));return e}function h(a){c.each(a,function(b,c){a[c]=l(c,b,a)});return a}function l(a,b,d){switch(a){case "chunk_size":if(b=
c.parseSize(b))d.send_file_name=!0;break;case "headers":var e={};"object"===typeof b&&c.each(b,function(a,b){e[b.toLowerCase()]=a});return e;case "http_method":return"PUT"===b.toUpperCase()?"PUT":"POST";case "filters":"array"===c.typeOf(b)&&(b={mime_types:b});b.mime_types&&("string"===c.typeOf(b.mime_types)&&(b.mime_types=c.mimes2extList(b.mime_types)),d.re_ext_filter=function(a){var b=[];c.each(a,function(a){c.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?b.push("\\.*"):b.push("\\."+
a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})});return new RegExp("("+b.join("|")+")$","i")}(b.mime_types));break;case "max_file_size":d&&!d.filters&&(d.filters={});d.filters.max_file_size=b;break;case "multipart":b||(d.send_file_name=!0);break;case "multipart_params":d.params=d.multipart_params=b;break;case "resize":return b?c.extend({preserve_headers:!0,crop:!1},b):!1;case "prevent_duplicates":d&&!d.filters&&(d.filters={});d.filters.prevent_duplicates=!!b;
break;case "unique_names":b&&(d.send_file_name=!0);break;case "required_features":return k(c.extend({},d));case "preferred_caps":return k(c.extend({},d,{required_features:!0}));case "container":case "browse_button":case "drop_element":return"container"===a?c.get(b):c.getAll(b)}return b}function n(a,b){r[a]=b}var r={},p;n("mime_types",function(a,b,d){a.length&&!this.getOption("re_ext_filter").test(b.name)?(this.trigger("Error",{code:c.FILE_EXTENSION_ERROR,message:c.translate("File extension error."),
file:b}),d(!1)):d(!0)});n("max_file_size",function(a,b,d){a=c.parseSize(a);void 0!==b.size&&a&&b.size>a?(this.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:b}),d(!1)):d(!0)});n("prevent_duplicates",function(a,b,d){var e=this;a&&this.forEachItem(function(a){b.name===a.name&&b.size===a.size&&(e.trigger("Error",{code:c.FILE_DUPLICATE_ERROR,message:c.translate("Duplicate file error."),file:b}),d(!1))});d(!0)});n("prevent_empty",function(a,b,d){a&&!b.size&&b.size!==
p?(this.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:b}),d(!1)):d(!0)});g.addFileFilter=n;c.inherit(g,b);c.addFileFilter=n;c.predictRuntime=function(a,b){var d=new g(a);var e=c.Runtime.thatCan(d.getOption("required_features"),b||a.runtimes);d.destroy();return e};return g});(function(c){for(var d=0;d<c.length;d++){for(var b=E,a=c[d],f=a.split(/[.\/]/),e=0;e<f.length-1;++e)b[f[e]]===D&&(b[f[e]]={}),b=b[f[e]];b[f[f.length-1]]=g[a]}})("plupload plupload/core/Collection plupload/core/ArrCollection plupload/core/Optionable plupload/core/Queueable plupload/core/Stats plupload/core/Queue plupload/QueueUpload plupload/QueueResize plupload/ChunkUploader plupload/FileUploader plupload/ImageResizer plupload/File plupload/Uploader".split(" "))})(this)});